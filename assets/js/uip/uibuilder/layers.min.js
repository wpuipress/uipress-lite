const{__:__,_x:_x,_n:_n,_nx:_nx}=wp.i18n;import{defineAsyncComponent,nextTick}from"../../libs/vue-esm-dev.js";export default{name:"layersRecursive",props:{content:Array,returnData:Function},components:{BlockList:defineAsyncComponent(()=>import("./block-list.min.js?ver=3.2.12"))},data(){return{items:this.content,queryLoopEnabled:__("Block is using query loop","uipress-lite"),drag:!1}},inject:["uiTemplate"],watch:{content:{handler(e,t){this.items=e},deep:!0},"$route.query.block":{handler(e,t){this.setOpenItems()},deep:!0}},methods:{returnDragStyle(){if(this.uiTemplate.drag)return"border-color:var(--uip-background-primary);"},openSettings(e){this.uipApp.blockControl.setActive(e,this.items)},isActive(e){if("block"in this.$route.query&&this.$route.query.block==e)return!0},buildClasses(e){let t="uip-border-rounder uip-padding-xxs";const n=this.isActive(e.uid);return t+=n?" uip-background-secondary uip-text-bold uip-text-inverse":" uip-background-muted",this.uipApp.blockControl&&!n&&this.uipApp.blockControl.returnHoveredBlockUID===e.uid&&(t+=" uip-background-primary-wash"),t},setOpenItems(){const e=t=>{for(let n of t)n.tabOpen=this.isContentOpen(n),n.content&&n.content.length>0&&e(n.content)};e(this.items)},isContentOpen(e){if(e.tabOpen)return!0;if(!e.content)return e.tabOpen;const t=JSON.stringify(e.content),n=this.$route.query.block;return!!t.includes(n)}},template:'\n    <div class="uip-border-round uip-h-100p uip-w-100p uip-flex uip-drop-area uip-template-layers"\n\t  :style="returnDragStyle()" :class="{\'uip-drop-hightlight\' : uiTemplate.drag}">\n           \n\t\t\t<uip-draggable \n\t\t\t  class="uip-flex uip-flex-column uip-row-gap-xxs uip-w-100p"\n\t  \t\t  :group="{ name: \'uip-blocks\', pull: true, put: true }"\n              :list="items"\n\t\t\t  ghost-class="uip-block-ghost"\n              handle=".uip-block-drag"\n              animation="300"\n\t\t\t  :sort="true">\n        \n            \n                  <div v-for="(element, index) in items" class="uip-border-round" :key="element.uid">\n                  \n                    <div class="uip-flex ui-flex-middle uip-flex-center uip-gap-xxs uip-block" style="min-width:160px" \n                    :class="buildClasses(element)" \n                    @click="openSettings(element)"\n                    @mouseenter.prevent.stop="uipApp.blockControl.setHover({},element)"\n                    @mouseleave.prevent.stop="uipApp.blockControl.removeHover({},element)"\n                    @contextmenu.prevent.stop="uipApp.blockcontextmenu.show({event: $event, list: items, index: index, block: element})">\n                      \n                      \n                      <div class="uip-cursor-pointer uip-icon uip-icon-small-emphasis uip-border-round uip-block-drag">drag_indicator</div>\n                      <div class="uip-cursor-pointer uip-icon uip-icon-small-emphasis">{{element.icon}}</div>\n                      \n                     \n                      \n                      <div class="uip-cursor-pointer uip-flex-grow uip-text-s uip-no-wrap uip-flex-center uip-flex-between uip-flex">\n                        <span>{{element.name}}</span>\n                        <span :title="queryLoopEnabled" v-if="hasNestedPath(element, [\'query\', \'enabled\'])" class="uip-cursor-pointer uip-icon uip-icon-small-emphasis uip-text-l">all_inclusive</span>\n                      </div>\n                      \n                      \x3c!--Chevs --\x3e\n                      <div v-if="element.content" class="uip-ratio-1-1 uip-icon uip-padding-xxxs uip-text-l uip-line-height-1 uip-cursor-pointer uip-flex uip-flex-center uip-margin-left-xs" type="button" @click.prevent.stop="element.tabOpen = !element.tabOpen">\n                        <span v-if="!element.tabOpen">chevron_left</span>\n                        <span v-if="element.tabOpen">expand_more</span>\n                      </div>\n                      \n                    </div>\n                    \n                    <div v-if="element.tabOpen && element.content" class="uip-margin-left-s uip-margin-top-xxs">\n                      \n                      \x3c!--Block selector--\x3e\n                      <div class="uip-flex uip-flex-center uip-flex-middle uip-flex-row uip-margin-bottom-xxs">\n                      \n                        <dropdown width="260" pos="right center" :onOpen="function(){uiTemplate.activePath = []}" triggerClass="uip-w-100p" class="uip-w-100p">\n                          <template v-slot:trigger>\n                            <div ref="footer" class="uip-text-muted uip-text-center uip-padding-xxs uip-text-center uip-icon uip-link-muted uip-border-rounder uip-border uip-cursor-pointer uip-w-100p uip-text-s" >add</div>\n                          </template>\n                          <template v-slot:content>\n                            <div class="uip-padding-s uip-max-w-300 uip-w-300 uip-max-h-300 uip-overflow-auto uip-scrollbar">\n                              <BlockList mode="click" :insertArea="element.content"/>\n                            </div>\n                          </template>\n                        </dropdown>\n                        \n                      </div>\n                      \x3c!--End block selector--\x3e\n                    \n                    \n                      <layersRecursive :content="element.content" :returnData="function(data){element.content = data}" />\n                    </div>\n                  </div>  \n        \n\t\t\t</uip-draggable>\n\t    \t\n\t\t</div>'};