const{__:__,_x:_x,_n:_n,_nx:_nx}=wp.i18n;import{defineAsyncComponent,nextTick}from"../../libs/vue-esm.js";export default{components:{Modal:defineAsyncComponent(()=>import("../v3.5/utility/modal.min.js?ver=3.3.1"))},props:{args:Object,triggerClass:String},data:()=>({modelOpen:!0,themeLoading:!1,themes:[],saving:!1,finished:!1,strings:{globalExport:__("Global export"),settingsExplanation:__("Choose the sections you wish to export to another site and click export to generate a file containing all of uiPress settings, templates, menus and theme styles","uipress-lite"),templates:__("Templates","uipress-lite"),siteSettings:__("Site settings","uipress-lite"),themeStyles:__("Theme styles","uipress-lite"),adminMenus:__("Admin menus","uipress-lite"),cancel:__("Cancel","uipress-lite"),export:__("Export","uipress-lite")},exportOptions:{templates:!0,siteSettings:!0,themeStyles:!0,adminMenus:!0}}),watch:{currentStep:{handler(e,t){2==e&&this.fetchThemes()}}},computed:{isDisabledButton(){if(!(this.exportOptions.templates||this.exportOptions.siteSettings||this.exportOptions.themeStyles||this.exportOptions.adminMenus))return!0}},methods:{async exportEverything(){let e=new FormData;e.append("action","uip_global_export"),e.append("security",uip_ajax.security),e.append("options",JSON.stringify(this.exportOptions));const t=this.uipApp.notifications.notify(__("Exporting uiPress content","uipress-lite"),"","default",!1,!0),i=await this.sendServerRequest(uip_ajax.ajax_url,e);i&&!i.error?this.downloadExport(i.export,t):this.uipApp.notifications.notify(i.message,"","error",!0)},async downloadExport(e,t){let i=this.prepareJSON({uipGlobalExport:e}),s=new Date,n=String(s.getDate()).padStart(2,"0"),p="uip-global-export--"+(String(s.getMonth()+1).padStart(2,"0")+"-"+n+"-"+s.getFullYear())+".json",o="data:text/json;charset=utf-8,"+encodeURIComponent(i),l=this.$refs.globalExport;l.setAttribute("href",o),l.setAttribute("download",p),l.click(),this.uipApp.notifications.notify(__("Export complete","uipress-lite"),"","success"),this.uipApp.notifications.remove(t)}},template:'\n    \n    \n      <Modal :startOpen="true" ref="globalexportwrap">\n      \n        <div ref="uipmodal" class="uip-flex uip-flex-column uip-row-gap-m uip-w-400 uip-padding-m">\n          \n          \n          \x3c!-- title --\x3e\n          <div class="uip-flex uip-flex-between uip-flex-center">\n            <div class="uip-text-bold">{{strings.globalExport}}</div>\n            <div class="uip-icon uip-link-muted uip-padding-xxs uip-border-round hover:uip-background-muted" @click="$refs.globalexportwrap.close();this.$router.push(\'/\');">close</div>\n          </div>\n          \x3c!-- end title --\x3e\n          \n          \n          <div class="uip-text-muted">{{strings.settingsExplanation}}</div>\n          \n          <div class="uip-flex uip-flex-column uip-row-gap-xs">\n            \n            <label class="uip-flex uip-gap-xs uip-flex-center">\n              <input class="uip-user-check uip-checkbox uip-margin-remove" v-model="exportOptions.templates" type="checkbox">\n              <div class="">{{strings.templates}}</div>\n            </label>\n            \n            <label class="uip-flex uip-gap-xs uip-flex-center">\n              <input class="uip-user-check uip-checkbox uip-margin-remove" v-model="exportOptions.siteSettings" type="checkbox">\n              <div class="">{{strings.siteSettings}}</div>\n            </label>\n            \n            <label class="uip-flex uip-gap-xs uip-flex-center">\n              <input class="uip-user-check uip-checkbox uip-margin-remove" v-model="exportOptions.themeStyles" type="checkbox">\n              <div class="">{{strings.themeStyles}}</div>\n            </label>\n            \n            <label class="uip-flex uip-gap-xs uip-flex-center">\n              <input class="uip-user-check uip-checkbox uip-margin-remove" v-model="exportOptions.adminMenus" type="checkbox">\n              <div class="">{{strings.adminMenus}}</div>\n            </label>\n          \n          </div>\n          \n          \n          <div class="uip-flex uip-flex-between uip-gap-xs">\n            <router-link to="/" class="uip-button-default uip-no-underline">{{strings.cancel}}</router-link>\n            \n            <button @click="exportEverything()" class="uip-button-primary" :disabled="isDisabledButton">{{strings.export}}</button>\n            \n          </div>\n          \n          <a class="uip-hidden" ref="globalExport"></a>\n          \n          \n        </div>\n        \n      </Modal>\n    \n    '};