const{__:__,_x:_x,_n:_n,_nx:_nx}=wp.i18n;export default{props:{display:String,name:String,block:Object},data(){return{menu:this.returnAdminMenu(),activeMenu:!1,workingMenu:[],activeLink:"",breadCrumbs:[{name:__("Home","uipress-lite"),url:this.uipApp.data.dynamicOptions.viewadmin.value}],menuDirection:this.block.settings.block.options.menuDirection.value.value,strings:{mainmenu:__("Main menu","uipress-lite"),collapseMenu:__("Collapse menu","uipress-lite")},collapsed:!1}},inject:["uiTemplate"],watch:{breadCrumbs:{handler(e,i){let n=new CustomEvent("uipress/app/breadcrumbs/update",{detail:{crumbs:this.breadCrumbs}});document.dispatchEvent(n)},deep:!0},collapsed:{handler(e,i){e?document.documentElement.setAttribute("uip-menu-collapsed","true"):document.documentElement.setAttribute("uip-menu-collapsed","false"),this.saveUserPreference("menuCollapsed",e,!1)}}},mounted(){this.buildMenu(),this.uipApp.data.userPrefs.menuCollapsed&&this.showCollapse&&(this.collapsed=!0),document.addEventListener("uipress/app/page/change",e=>{""==e.detail.url?this.activeLink=e.detail.url:this.activeLink=e.detail.url.replaceAll("%2F","/")},{once:!1}),document.addEventListener("uipress/app/page/load/finish",e=>{self.updateMenuFromFrame()},{once:!1})},computed:{subMenuStyle(){return this.collapsed?"hover":this.block.settings.block.options.subMenuStyle.value.value},subMenuCustomIcon(){let e=this.get_block_option(this.block,"block","subMenuIcon");return!!e.value&&e.value},menuAutoUpdate(){let e=this.get_block_option(this.block,"block","disableAutoUpdate");return this.isObject(e)?e.value:e},disableAutoLoad(){let e=this.get_block_option(this.block,"block","loadOnClick");return this.isObject(e)?e.value:e},showCollapse(){let e=this.get_block_option(this.block,"block","menuCollapse");return this.isObject(e)?e.value:e}},methods:{returnAdminMenu(){let e=this.hasNestedPath(this.uipApp.data,["adminMenu","menu"]);return e?JSON.parse(JSON.stringify(e)):[]},buildMenu(){let e=this.activeLink,i=this,n={},t=!1,u=this.checkForadvancedMenu(this.menu);i.breadCrumbs=[{name:__("Home","uipress-lite"),url:i.uipApp.data.dynamicOptions.viewadmin.value}];for(const s of u){s.active&&(n=s),"open"in u||(u.open=!1),"url"in s&&(s.url=i.santize(s.url)),"name"in s&&(s.name=i.santize(s.name));let a=i.workingMenu.find(e=>e.uid==s.uid);void 0!==a&&a.open&&(s.open=!0),s.active=!1,""!=e&&s.url==e&&(s.active=!0,t=!0,i.breadCrumbs.push({name:s.name,url:s.url}));let l=!1;if(s.submenu&&s.submenu.length>0)for(const n of s.submenu)n.active=!1,"url"in n&&(n.url=i.santize(n.url)),"name"in n&&(n.name=i.santize(n.name)),""!=e&&n.url==e&&(n.active=!0,t=!0,l=n,i.breadCrumbs.push({name:n.name,url:n.url}));l&&(s.active=!0,i.activeMenu=s,i.breadCrumbs=[{name:__("Home","uipress-lite"),url:i.uipApp.data.dynamicOptions.viewadmin.value}],i.breadCrumbs.push({name:s.name,url:s.url}),i.breadCrumbs.push({name:l.name,url:l.url}))}return t||(n.active=!0),i.workingMenu=u,i.workingMenu},returnCustomMenu(){let e=this.get_block_option(this.block,"block","advancedoptions");return void 0!==e&&(!!e&&(!!Array.isArray(e)&&(!(e.length<1)&&e)))},checkForadvancedMenu(e){if(!this.returnCustomMenu())return e;let i=JSON.parse(JSON.stringify(this.returnCustomMenu())),n=[],t=this.menuAutoUpdate,u=[];for(let i of e)if("uid"in i&&u.push(i),"submenu"in i)for(let e of i.submenu)"uid"in e&&u.push(e);for(let e of i){if("uid"in e){n.push(e.uid);let i=u.find(i=>i.uid==e.uid);if(void 0!==i){e.notifications=i.notifications;let n=e[0];if(n.includes("<")){n=e[0].split("<")[0]}n.trim().toLowerCase()==e.name.trim().toLowerCase()&&(e.name=i.name)}}if("submenu"in e)for(let i of e.submenu)if("uid"in i){n.push(i.uid);let e=u.find(e=>e.uid==i.uid);if(void 0!==e){i.notifications=e.notifications;let n=i[0];if(n.includes("<")){n=i[0].split("<")[0]}n.trim().toLowerCase()==i.name.trim().toLowerCase()&&(i.name=e.name)}}}if(t)return i;let s=[];for(let[t,u]of e.entries()){let e=!1;if("uid"in u&&(e=u.uid,s.push(e),!n.includes(e)))i.splice(t,0,u);else if("submenu"in u&&Array.isArray(u.submenu)&&!(u.submenu.length<1))for(let[t,a]of u.submenu.entries())if("uid"in a){let t=a.uid;if(s.push(t),!n.includes(t)){let u=i.filter(i=>i.uid==e);if(void 0!==u&&u.length>0){"submenu"in u[0]||(u[0].submenu=[]),n.push(a.name+t);continue}i.push(a),n.push(a.name+t)}}}for(var a=i.length-1;a>=0;a--){let e=i[a];if("uid"in e&&(e.custom||s.includes(e.uid)||i.splice(a,1)),"submenu"in e)for(var l=e.submenu.length-1;l>=0;l--){let i=e.submenu[l];"uid"in i&&(i.custom||s.includes(i.uid)||e.submenu.splice(a,1))}}return"prod"!=this.uiTemplate.display&&(this.block.settings.block.options.advancedoptions.value=i),i},updateMenuFromFrame(){let e=document.getElementsByClassName("uip-page-content-frame"),i=this;if(e[0]){let n=e[0];if(n.contentWindow.uipMasterMenu&&void 0!=typeof n.contentWindow.uipMasterMenu){let e=n.contentWindow.uipMasterMenu;if(void 0===e)return;if(!("menu"in e))return;let t=JSON.parse(JSON.stringify(e.menu));0,i.menu=t,i.buildMenu()}}},activeItem(e,i,n){if(i.ctrlKey||i.shiftKey||i.metaKey||i.button&&1==i.button)return;if(i.preventDefault(),n){if(this.disableAutoLoad&&e.submenu&&e.submenu.length>0)return e.open=!e.open,void(this.activeMenu=e);e.active=!0}let t=this;e.submenu&&e.submenu.length>0&&(this.activeMenu=e);let u=new RegExp("^(?:[a-z+]+:)?//","i"),s=e.url;if(u.test(s)||(s=this.uipApp.data.dynamicOptions.viewadmin.value+s),e.withoutFrame){let e=new URL(s);e.searchParams.set("uip-framed-page",1),s=e.href}if(e.withoutUiPress){let i=new URL(s),n=t.createUID();i.searchParams.set("uipwf",n),i.searchParams.set("uip-framed-page",0),s=i.href;let u=new FormData;return u.append("action","uip_create_frame_switch"),u.append("security",uip_ajax.security),u.append("uid",n),void t.sendServerRequest(uip_ajax.ajax_url,u).then(i=>{e.newTab?(this.$refs.newTab.href=s,this.$refs.newTab.click(),this.$refs.newTab.href="",this.$refs.newTab.blur()):this.updateAppPage(s,!0)})}if(e.newTab||e.withoutFrame)return this.$refs.newTab.href=s,this.$refs.newTab.click(),this.$refs.newTab.href="",void this.$refs.newTab.blur();this.updateAppPage(e.url)},hideIcons(){return!this.collapsed&&this.block.settings.block.options.hideIcons.value},returnDirection(){let e=this.get_block_option(this.block,"block","menuDirection");return e&&"value"in e?"vertical"==e.value?"uip-flex-column":"uip-flex-row uip-flex-wrap":"uip-flex-column"},returnDropPos(){let e=this.get_block_option(this.block,"block","menuDirection");return e&&"value"in e?"horizontal"==e.value?"bottom-left":"right":"bottom-left"},isMenuHorizontal(){return"horizontal"==this.block.settings.block.options.menuDirection.value.value},returnClasses(){let e="";return this.collapsed&&(e+=" uip-menu-collapsed"),e},returnSubIcon(e){return this.subMenuCustomIcon?this.subMenuCustomIcon:e.open||e.active?"expand_more":"chevron_left"},returnTopIcon:e=>e&&e.includes("uipblank")?e.replace("uipblank","favorite"):e,santize:e=>void 0===e?"":""==e.url?"":e.replace(/&amp;/g,"&")},template:'\n    \n          <div class="uip-admin-menu uip-text-normal uip-flex uip-flex-column" :id="block.uid" :class="returnClasses()">\n    \n            \n            \x3c!--INLINE DROP MENU--\x3e\n            <template v-if="subMenuStyle == \'inline\' && !isMenuHorizontal()">\n              <div class="uip-flex" :class="returnDirection()">\n            \n                <template v-for="item in workingMenu">\n                \n                  <template v-if="!item.hidden">\n                \n                    <div v-if="item.type != \'sep\'" class="uip-flex uip-flex-column uip-row-gap-xs">\n                    \n                      <a :href="item.url" @click="activeItem(item, $event, true)" class="uip-unset-all uip-link-focus uip-flex uip-gap-xxs uip-flex-center uip-cursor-pointer uip-top-level-item uip-margin-bottom-xs" :class="[{\'uip-top-level-item-active\' : item.active}, item.customClasses]">\n                        <div v-if="!hideIcons()" v-html="returnTopIcon(item.icon)" class="uip-flex uip-flex-center uip-menu-icon uip-icon uip-icon-medium"></div>\n                        <div class="uip-flex-grow uip-flex uip-gap-xs uip-flex-center">\n                          <div>{{item.name}}</div>\n                          <div v-if="item.notifications && item.notifications > 0" class="uip-border-round uip-h-14 uip-ratio-1-1 uip-background-secondary uip-text-inverse uip-text-xxs uip-text-bold uip-flex uip-flex-center uip-flex-middle uip-menu-notification"><span>{{item.notifications}}</span></div>\n                        </div>\n                        \n                        <template v-if="item.submenu && item.submenu.length > 0">\n                          <div class="uip-icon uip-margin-left-auto">{{returnSubIcon(item)}}</div>\n                        </template>\n                        \n                      </a>\n                      <div v-if="item.submenu && (item.active || item.open) && item.submenu.length > 0" class="uip-admin-submenu uip-margin-left-s uip-margin-bottom-s">\n                        <div class="uip-flex uip-flex-column uip-row-gap-xxs">\n                          <template v-for="sub in item.submenu">\n                          \n                            <template v-if="!sub.hidden">\n                            \n                              <div v-if="sub.type != \'sep\'" class="uip-flex-grow uip-flex uip-gap-xs uip-flex-center">\n                                <a :href="sub.url" @click="activeItem(sub, $event)" :class="[{\'uip-sub-level-item-active\' : sub.active}, sub.customClasses]" class="uip-unset-all uip-link-focus uip-cursor-pointer uip-sub-level-item">{{sub.name}}</a>\n                                <div v-if="sub.notifications && sub.notifications > 0" class="uip-border-circle uip-w-14 uip-h-14 uip-ratio-1-1 uip-background-secondary uip-text-inverse uip-text-xxs uip-flex uip-flex-center uip-flex-middle uip-menu-notification"><span>{{sub.notifications}}</span></div>\n                              </div>\n                              \n                              <div v-else-if="!sub.name" class="uip-margin-bottom-s uip-menu-separator"></div>\n                              \n                              <div v-else class="uip-margin-bottom-s uip-margin-top-s uip-flex uip-flex-row uip-gap-xxs uip-menu-separator">\n                                <span v-if="sub.icon" class="uip-icon">{{sub.icon}}</span>\n                                <span>{{sub.name}}</span>\n                              </div>\n                              \n                            </template>\n                            \n                          </template>\n                        </div>\n                      </div>\n                    </div>\n                    \n                    <div v-else-if="!item.name" class="uip-margin-bottom-s uip-menu-separator"></div>\n                    \n                    <div v-else class="uip-margin-bottom-s uip-margin-top-s uip-flex uip-flex-row uip-gap-xxs uip-menu-separator">\n                      <span v-if="item.icon" class="uip-icon">{{item.icon}}</span>\n                      <span>{{item.name}}</span>\n                    </div>\n                  \n                  </template>\n                  \n                </template>\n              \n              </div>\n            </template>\n            \x3c!--END INLINE DROP MENU--\x3e\n            \n            \n            \n            \n            \x3c!--HOVER DROP MENU--\x3e\n            <template v-if="subMenuStyle == \'hover\' || isMenuHorizontal()">\n              <div class="uip-flex" :class="returnDirection()">\n                <template v-for="item in workingMenu">\n                \n                \n                  <template v-if="!item.hidden">\n                  \n                    <template v-if="item.type != \'sep\'">\n                  \n                      <dropdown :hover="true" triggerClass="uip-flex uip-flex-grow" :pos="returnDropPos()">\n                        <template v-slot:trigger>\n                          <a :href="item.url" @click="activeItem(item, $event)" class="uip-unset-all uip-link-focus uip-flex uip-gap-xxs uip-flex-center uip-cursor-pointer uip-top-level-item uip-margin-bottom-xs uip-w-100p"\n                          :class="[{\'uip-top-level-item-active\' : item.active}, item.customClasses]">\n                            <div v-if="!hideIcons()" v-html="returnTopIcon(item.icon)" class="uip-flex uip-flex-center uip-menu-icon uip-icon uip-icon-medium"></div>\n                            <div class="uip-flex-grow uip-flex uip-gap-xs uip-flex-center uip-line-height-1" v-if="!collapsed">\n                              <div class="">{{item.name}}</div>\n                              <div v-if="item.notifications && item.notifications > 0" class="uip-border-circle uip-w-14 uip-h-14 uip-ratio-1-1 uip-background-secondary uip-text-inverse uip-text-xxs uip-text-bold uip-flex uip-flex-center uip-flex-middle uip-menu-notification"><span>{{item.notifications}}</span></div>\n                            </div>\n                          </a>\n                        </template>\n                        <template v-slot:content v-if="item.submenu && item.submenu.length > 0">\n                          <div class="uip-admin-submenu uip-padding-xs">\n                            <div class="uip-flex uip-flex-column uip-row-gap-xxs">\n                              <a :href="item.url" @click="activeItem(item, $event)" class="uip-unset-all uip-link-focus uip-flex uip-gap-xxs uip-flex-center uip-sub-menu-header uip-margin-bottom-xs"\n                              :class="{\'uip-top-level-item-active\' : item.active}">\n                                <div v-if="!hideIcons()" v-html="item.icon" class="uip-flex uip-flex-center uip-menu-icon uip-icon"></div>\n                                <div class="uip-flex-grow" v-html="item.name"></div>\n                              </a>\n                              <template v-for="sub in item.submenu">\n                              \n                                <template v-if="!sub.hidden">\n                                \n                                  <div v-if="sub.type != \'sep\'" class="uip-flex-grow uip-flex uip-gap-xs uip-flex-center">\n                                    <a :href="sub.url" @click="activeItem(sub, $event)" :class="[{\'uip-sub-level-item-active\' : sub.active}, sub.customClasses]" class="uip-unset-all uip-link-focus uip-cursor-pointer uip-sub-level-item">\n                                      {{sub.name}}\n                                    </a>\n                                    <div v-if="sub.notifications && sub.notifications > 0" class="uip-border-circle uip-w-14 uip-h-14 uip-ratio-1-1 uip-background-secondary uip-text-inverse uip-text-xxs uip-flex uip-flex-center uip-flex-middle uip-menu-notification"><span>{{sub.notifications}}</span></div>\n                                  </div>\n                                  \n                                  <div v-else-if="!sub.name" class="uip-margin-bottom-s uip-menu-separator"></div>\n                                  \n                                  <div v-else class="uip-margin-bottom-s uip-margin-top-s uip-flex uip-flex-row uip-gap-xxs uip-menu-separator">\n                                    <span v-if="sub.icon" class="uip-icon">{{sub.icon}}</span>\n                                    <span>{{sub.name}}</span>\n                                  </div>\n                                \n                                </template>\n                                \n                              </template>\n                            </div>\n                          </div>\n                        </template>\n                      </dropdown>\n                    \n                    </template>\n                    \n                    \n                    <div v-else-if="!item.name" class="uip-margin-bottom-s uip-menu-separator"></div>\n                    \n                    <div v-else class="uip-margin-bottom-s uip-margin-top-s uip-flex uip-flex-row uip-gap-xxs uip-menu-separator">\n                      <span v-if="item.icon && !collapsed" class="uip-icon">{{item.icon}}</span>\n                      <span v-if="!collapsed">{{item.name}}</span>\n                    </div>\n                    \n                  </template>  \n                  \n                  \n                </template>\n              </div>\n            </template>\n            \x3c!--END HOVER DROP MENU--\x3e\n            \n            \n            \n            \x3c!--DYNAMIC MENU--\x3e\n            <template v-if="subMenuStyle == \'dynamic\' && !isMenuHorizontal()">\n              <div class="uip-flex uip-gap-x" :class="returnDirection()">\n                <template v-if="activeMenu == false" v-for="item in workingMenu">\n                \n                  <template v-if="!item.hidden">\n                  \n                    <template v-if="item.type != \'sep\'">\n                      <a :href="item.url" @click="activeItem(item, $event, true)" class="uip-unset-all uip-link-focus uip-flex uip-gap-xxs uip-flex-center uip-cursor-pointer uip-top-level-item uip-margin-bottom-xs"\n                      :class="[{\'uip-top-level-item-active\' : item.active}, item.customClasses]" >\n                        <div v-if="!hideIcons()" v-html="returnTopIcon(item.icon)" class="uip-flex uip-flex-center uip-menu-icon uip-icon uip-icon-medium"></div>\n                        <div class="uip-flex-grow uip-flex uip-gap-xs uip-flex-center uip-line-height-1">\n                          <div>{{item.name}}</div>\n                          <div v-if="item.notifications && item.notifications > 0" class="uip-border-circle uip-w-14 uip-h-14 uip-ratio-1-1 uip-background-secondary uip-text-inverse uip-text-xxs uip-text-bold uip-flex uip-flex-center uip-flex-middle uip-menu-notification"><span>{{item.notifications}}</span></div>\n                        </div>\n                        <template v-if="!subMenuCustomIcon && item.submenu && item.submenu.length > 0">\n                          <div class="uip-icon uip-margin-left-auto">chevron_right</div>\n                        </template>\n                        <div v-else-if="item.submenu && item.submenu.length > 0" class="uip-icon uip-margin-left-auto uip-submenu-icon" >{{subMenuCustomIcon}}</div>\n                      </a>\n                    </template>\n                    \n                    <div v-else-if="!item.name" class="uip-margin-bottom-s uip-menu-separator"></div>\n                    \n                    <div v-else class="uip-margin-bottom-s uip-margin-top-s uip-flex uip-flex-row uip-gap-xxs uip-menu-separator">\n                      <span v-if="item.icon" class="uip-icon">{{item.icon}}</span>\n                      <span>{{item.name}}</span>\n                    </div>\n                  \n                  </template>\n                  \n                  \n                </template>\n                \n                \n                \n                <template v-else>\n                \n                  <div class="uip-flex uip-flex-column uip-row-gap-m uip-slide-in-right">\n                    <div class="uip-flex uip-gap-xxs uip-flex-row uip-flex-center uip-cursor-pointer" @click="activeMenu = false">\n                      <div class="uip-icon uip-icon-medium">chevron_left</div>\n                      <div class="uip-flex-grow">{{strings.mainmenu}}</div>\n                    </div>\n                    <div class="uip-flex uip-gap-xxs uip-flex-row uip-flex-center uip-text-bold uip-text-l uip-sub-menu-header">\n                      <div class="uip-flex-grow" v-html="activeMenu.name"></div>\n                    </div>\n                    <div v-if="activeMenu.submenu" class="uip-admin-submenu">\n                      <div class="uip-flex uip-flex-column uip-row-gap-xxs">\n                        <template v-for="sub in activeMenu.submenu">\n                          \n                          <template v-if="!sub.hidden">\n                          \n                            <div v-if="sub.type != \'sep\'" class="uip-flex-grow uip-flex uip-gap-xs uip-flex-center" :class="sub.customClasses">\n                              <a :href="sub.url" @click="activeItem(sub, $event)" :class="{\'uip-sub-level-item-active\' : sub.active}" class="uip-unset-all uip-link-focus uip-cursor-pointer uip-sub-level-item">{{sub.name}}</a>\n                              <div v-if="sub.notifications && sub.notifications > 0" class="uip-border-circle uip-w-14 uip-h-14 uip-ratio-1-1 uip-background-secondary uip-text-inverse uip-text-xxs uip-flex uip-flex-center uip-flex-middle uip-menu-notification"><span>{{sub.notifications}}</span></div>\n                            </div>\n                            \n                            <div v-else-if="!sub.name" class="uip-margin-bottom-s uip-menu-separator"></div>\n                            \n                            <div v-else class="uip-margin-bottom-s uip-margin-top-s uip-flex uip-flex-row uip-gap-xxs uip-menu-separator">\n                              <span v-if="sub.icon" class="uip-icon">{{sub.icon}}</span>\n                              <span>{{sub.name}}</span>\n                            </div>\n                          \n                          </template>\n                          \n                        </template>\n                      </div>\n                    </div>\n                  </div>\n                </template>\n              </div>\n            </template>\n            \x3c!--END DYNAMIC MENU--\x3e\n            <a ref="newTab" target="_BLANK" class="uip-hidden"></a>\n            \n            <div v-if="showCollapse" class="uip-flex uip-flex-row uip-gap-xxs uip-flex-center uip-link-muted uip-margin-top-m uip-menu-collapse" @click="collapsed = !collapsed">\n              <div v-if="collapsed" class="uip-icon uip-text-xl">chevron_right</div>\n              <div v-if="!collapsed" class="uip-icon uip-text-xl">chevron_left</div>\n              <div v-if="!collapsed">{{strings.collapseMenu}}</div>\n            </div>\n            \n          </div>'};