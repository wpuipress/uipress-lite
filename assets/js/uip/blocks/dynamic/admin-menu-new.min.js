const{__:__,_x:_x,_n:_n,_nx:_nx}=wp.i18n,MenuCollapse={inject:["uipress"],props:{collapsed:Boolean,returnData:Function},data(){return{strings:{collapseMenu:__("Collapse menu","uipress-lite")},isCollapsed:this.collapsed}},methods:{toggleCollapse(){this.isCollapsed=!this.isCollapsed,this.returnData(this.isCollapsed)}},template:'\n    \n          <div class="uip-flex uip-flex-row uip-gap-xs uip-flex-center uip-link-muted uip-margin-top-s uip-menu-collapse" \n          @click="toggleCollapse()">\n            <div v-if="isCollapsed" class="uip-icon uip-text-">arrow_forward_ios</div>\n            <div v-if="!isCollapsed" class="uip-icon uip-text-">arrow_back_ios</div>\n            <div v-if="!isCollapsed">{{strings.collapseMenu}}</div>\n          </div>\n    \n  '},MenuSearch={inject:["uipress"],emits:["searching"],props:{workingMenu:Array,maybeFollowLink:Function},data:()=>({strings:{search:__("Search menu","uipress-lite")},menuSearch:"",menuSearchIndex:0}),watch:{menuSearch:{handler(){if(this.menuSearchIndex=0,""==this.menuSearch)return this.$emit("searching",!1);this.$emit("searching",!0)}}},computed:{searchItems(){const e=this.menuSearch.toLowerCase(),n=({name:n,type:i})=>"sep"!==i&&n.toLowerCase().includes(e);return this.workingMenu.filter(n).concat(this.workingMenu.filter(e=>e.submenu).flatMap(e=>e.submenu.filter(n).map(n=>({...n,parent:e.name}))))}},methods:{watchForArrows(e){switch(e.key){case"Enter":const n=document.querySelector(`#uip-menu-search-results [data-id="${this.menuSearchIndex}"]`);n&&n.click();break;case"ArrowDown":this.menuSearchIndex=this.menuSearchIndex>=this.searchItems.length-1?0:this.menuSearchIndex++;break;case"ArrowUp":this.menuSearchIndex=this.menuSearchIndex<=0?this.searchItems.length-1:this.menuSearchIndex--}}},template:'\n    \n          <div class="uip-flex uip-menu-search uip-border-round uip-margin-bottom-s uip-flex-center">\n            <span class="uip-icon uip-text-muted uip-margin-right-xs uip-icon">search</span>\n            <input @keydown="watchForArrows" ref="menusearcher" class="uip-blank-input uip-flex-grow uip-text-s" type="search" :placeholder="strings.search" v-model="menuSearch">\n          </div>\n          \n          \n          <div v-if="menuSearch" class="uip-flex uip-flex-column uip-row-gap-xxs" id="uip-menu-search-results">\n          \n            <template v-for="(item, index) in searchItems">\n            \n                <a class="uip-flex uip-flex- uip-gap-xxxs uip-link-default uip-no-underline uip-flex-center uip-text-s uip-padding-xxxs uip-border-rounder"\n                @click="maybeFollowLink($event, item)"\n                :class="menuSearchIndex == index ? \'uip-background-high-light\' : \'\'" :href="item.url" :data-id="index">\n                  \n                  <span class="uip-text-muted" v-if="item.parent">{{item.parent}}</span>\n                  <span class="uip-icon" v-if="item.parent">chevron_right</span>\n                  <span class="">{{item.name}}</span>\n                  \n                </a>\n              \n            </template>\n          \n          </div>\n    \n  '},SubMenuItem={inject:["uipress"],props:{maybeFollowLink:Function,item:Object,collapsed:Boolean,block:Object},data:()=>({}),computed:{},methods:{sepHasCustomName(e){return this.uipress.checkNestedValue(e,["custom","name"])}},template:'\n    \n          <div class="uip-admin-submenu">\n          \n              <template v-for="sub in item.submenu">\n              \n                  \x3c!-- Normal subitem --\x3e\n                  <div v-if="sub.type != \'sep\'" class="uip-flex-grow uip-flex uip-gap-xs uip-flex-center">\n                    \n                    \x3c!-- Main link --\x3e\n                    <a :href="sub.url" @click="maybeFollowLink($event, sub)" :class="sub.customClasses" \n                    class="uip-no-underline uip-link-muted uip-sub-level-item" :active="sub.active ? true : false">\n                      {{sub.name}}\n                    </a>\n                    \n                    \x3c!-- Notifications count --\x3e\n                    <div v-if="sub.notifications && sub.notifications > 0" \n                    class="uip-border-circle uip-w-14 uip-h-14 uip-ratio-1-1 uip-background-secondary uip-text-inverse uip-text-xxs uip-flex uip-flex-center uip-flex-middle uip-menu-notification">\n                      <span>{{sub.notifications}}</span>\n                    </div>\n                    \n                  </div>\n                  \n                  \x3c!-- Normal seperator--\x3e\n                  <div v-else-if="!sepHasCustomName(sub)" class="uip-margin-bottom-s uip-menu-separator"></div>\n                  \n                  \x3c!-- Named seperator--\x3e\n                  <div v-else class="uip-margin-bottom-s uip-margin-top-s uip-flex uip-flex-row uip-gap-xxs uip-menu-separator">\n                    <span v-if="sub.custom.icon && sub.custom.icon != \'uipblank\'" class="uip-icon">{{sub.custom.icon}}</span>\n                    <span>{{sub.custom.name}}</span>\n                  </div>\n                \n              </template>\n              \n          </div>\n    \n  '},TopLevelItem={inject:["uipress"],props:{maybeFollowLink:Function,item:Object,collapsed:Boolean,block:Object},data:()=>({}),computed:{subMenuStyle(){if(this.collapsed)return"hover";let e=this.uipress.get_block_option(this.block,"block","subMenuStyle");return this.isObject(e)&&e.value?e.value:"dynamic"},subMenuCustomIcon(){let e=this.uipress.get_block_option(this.block,"block","subMenuIcon");return!!this.isObject(e)&&(!!e.value&&e.value)},hideIcons(){if(this.collapsed)return!1;const e=this.uipress.checkNestedValue(this.block,["settings","block","options","hideIcons","value"]);return this.isObject(e)?e.value:e}},methods:{returnTopIcon:e=>!!e&&e.includes("uipblank")?e.replace("uipblank","favorite"):e,returnSubIcon(e){return this.subMenuCustomIcon?this.subMenuCustomIcon:"dynamic"==this.subMenuStyle?"chevron_right":"hover"==this.subMenuStyle?"chevron_right":e.open||e.active?"expand_more":"chevron_left"}},template:'\n    \n    <a :href="item.url" @click="maybeFollowLink($event, item, true)" class="uip-no-underline uip-link-default uip-top-level-item" :class="item.customClasses" :active="item.active ? true : false">\n    \n      <div v-if="!hideIcons && item.icon" v-html="returnTopIcon(item.icon)" class="uip-flex uip-flex-center uip-menu-icon uip-icon uip-icon-medium"></div>\n      \n      <div v-if="!collapsed" class="uip-flex-grow uip-flex uip-gap-xs uip-flex-center">\n        <div class="uip-line-height-1" v-html="item.name"></div>\n        <div v-if="item.notifications && item.notifications > 0" class="uip-border-round uip-h-14 uip-ratio-1-1 uip-background-secondary uip-text-inverse uip-text-xxs uip-text-bold uip-flex uip-flex-center uip-flex-middle uip-menu-notification"><span>{{item.notifications}}</span></div>\n      </div>\n      \n      <div v-if="item.submenu && item.submenu.length > 0 && !collapsed" class="uip-icon uip-link-muted">{{returnSubIcon(item)}}</div>\n      \n    </a>\n    \n  '},DrillDown={inject:["uipress"],components:{TopLevelItem:TopLevelItem,SubMenuItem:SubMenuItem,MenuSearch:MenuSearch,MenuCollapse:MenuCollapse},props:{maybeFollowLink:Function,item:Object,collapsed:Boolean,block:Object,menuItems:Array,returnCollapsed:Function},watch:{menuItems:{handler(){this.initializeMenu()},immediate:!0,deep:!0},isCollapsed:{handler(){this.returnCollapsed(this.isCollapsed)}}},data(){return{currentLevel:[],levels:[],currentItem:null,searching:!1,isCollapsed:this.collapsed}},computed:{parentItemName(){return this.currentItem?this.decodeHtmlEntities(this.currentItem.name):__("Go back","uipress-lite")},hasMenuSearch(){const e=this.uipress.get_block_option(this.block,"block","showSearch");return this.isObject(e)?e.value:e},hasMenuCollapse(){const e=this.uipress.get_block_option(this.block,"block","menuCollapse");return this.isObject(e)?e.value:e}},methods:{drillDown(e){this.levels.push(this.currentLevel),this.currentItem=e,this.currentLevel=e.submenu},goBack(){this.currentLevel=this.levels.pop()},initializeMenu(){this.currentLevel=this.menuItems},handleLinkClick(e,n){if(n.submenu&&n.submenu.length)return this.drillDown(n),void e.preventDefault();this.maybeFollowLink(e,n)},decodeHtmlEntities:e=>e?e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&#39;/g,"'").replace(/&nbsp;/g," ").replace(/%20/g," "):""},template:'\n    \n             \n              \n              <Transition name="translate" mode="out-in">\n                <div :key="currentLevel" class="uip-admin-menu uip-text-normal" :class="{\'uip-menu-collapsed\' : collapsed}">\n                \n                  <MenuSearch v-if="hasMenuSearch" \n                  key="menusearch"\n                  @searching="(d)=>{searching = d}"\n                  :maybeFollowLink="maybeFollowLink" :workingMenu="menuItems"/>\n                \n                  \x3c!-- Display Back button if there are levels to go back to --\x3e\n                  <a v-if="levels.length" \n                  class="uip-flex uip-gap-xxs uip-flex-center uip-flex-row uip-flex-center uip-text-bold uip-text-l uip-sub-menu-header uip-link-default uip-margin-bottom-s uip-gap-xxs" \n                  @click="goBack">\n                    <div class="uip-icon">chevron_left</div>\n                    <div class="uip-flex-grow" v-html="parentItemName"></div>\n                  </a>\n                  \n                  \x3c!-- Loop through currentLevel and display each item --\x3e\n                  <template v-for="item of currentLevel">\n                    <TopLevelItem :item="item" :maybeFollowLink="handleLinkClick" :collapsed="isCollapsed" :block="block"/>\n                  </template>\n                  \n                  <MenuCollapse v-if="hasMenuCollapse" :collapsed="isCollapsed" :returnData="(d) => {isCollapsed = d}"/>\n                  \n                </div>\n              </Transition>\n              \n    \n  '};export default{props:{display:String,name:String,block:Object},components:{TopLevelItem:TopLevelItem,SubMenuItem:SubMenuItem,DrillDownMenu:DrillDown,MenuSearch:MenuSearch,MenuCollapse:MenuCollapse},data(){return{menu:[],activeMenu:!1,workingMenu:[],activeLink:"",breadCrumbs:[{name:__("Home","uipress-lite"),url:this.uipApp.data.dynamicOptions.viewadmin.value}],searching:!1,staticMenu:[],strings:{mainmenu:__("Main menu","uipress-lite"),collapseMenu:__("Collapse menu","uipress-lite"),search:__("Search menu","uipress-lite")},collapsed:!1}},inject:["uipress","uiTemplate"],watch:{breadCrumbs:{handler(e,n){let i=new CustomEvent("uip_breadcrumbs_change",{detail:{crumbs:this.breadCrumbs}});document.dispatchEvent(i)},deep:!0},collapsed:{handler(e,n){let i=!!e;document.documentElement.setAttribute("uip-menu-collapsed",String(i)),this.uiTemplate.menuCollapsed=i,this.uipress.saveUserPreference("menuCollapsed",i,!1)}}},created(){this.setMenu(),this.buildMenu()},mounted(){this.mountEventListeners()},computed:{subMenuStyle(){if(this.collapsed)return"hover";let e=this.uipress.get_block_option(this.block,"block","subMenuStyle");return this.isObject(e)&&e.value?e.value:"dynamic"},subMenuCustomIcon(){let e=this.uipress.get_block_option(this.block,"block","subMenuIcon");return!!this.isObject(e)&&(!!e.value&&e.value)},autoLoadIsDisabled(){const e=this.uipress.get_block_option(this.block,"block","loadOnClick");return this.isObject(e)?e.value:e},hasMenuCollapse(){const e=this.uipress.get_block_option(this.block,"block","menuCollapse");return this.isObject(e)?e.value:e},hasMenuSearch(){const e=this.uipress.get_block_option(this.block,"block","showSearch");return this.isObject(e)?e.value:e},returnDropdownPosition(){const e=this.uipress.get_block_option(this.block,"block","dropdownPosition");return this.isObject(e)&&e.value?e.value:"right top"},returnClasses(){if(this.collapsed)return"uip-menu-collapsed"},hideIcons(){if(this.collapsed)return!1;const e=this.uipress.checkNestedValue(this.block,["settings","block","options","hideIcons","value"]);return this.isObject(e)?e.value:e}},beforeUnmount(){document.removeEventListener("uip_page_change",this.updateActiveLink,{once:!1}),document.removeEventListener("uip_page_change_loaded",this.updateMenuFromFrame,{once:!1})},methods:{setMenu(){this.menu=JSON.parse(JSON.stringify(this.uipApp.data.adminMenu.menu)),this.uipApp.data.userPrefs.menuCollapsed&&this.hasMenuCollapse&&(this.collapsed=!0)},mountEventListeners(){document.addEventListener("uip_page_change",this.updateActiveLink,{once:!1}),document.addEventListener("uip_page_change_loaded",this.updateMenuFromFrame,{once:!1})},updateActiveLink(e){this.activeLink=e.detail.url?e.detail.url.replaceAll("%2F","/"):e.detail.url},buildMenu(){const e=this.activeLink;if(!e)return this.workingMenu=this.menu;this.breadCrumbs=[{name:__("Home","uipress-lite"),url:this.uipApp.data.dynamicOptions.viewadmin.value}];const n=n=>{n.active=!1,n.url=n.url?this.decodeHtmlEntities(n.url):void 0,n.name=n.name?this.decodeHtmlEntities(n.name):void 0,n.url===e&&(n.active=!0,this.breadCrumbs.push({name:n.name,url:n.url}))};this.menu.forEach(i=>{i.active=!1,i.url=i.url?this.decodeHtmlEntities(i.url):void 0,i.name=i.name?this.decodeHtmlEntities(i.name):void 0;const t=this.workingMenu.find(e=>e.uid===i.uid);!!t&&t.open&&(i.open=!0),i.url===e&&(i.active=!0,this.breadCrumbs.push({name:i.name,url:i.url})),i.submenu&&i.submenu.forEach(n)}),this.workingMenu=this.menu},updateMenuFromFrame(){const e=document.querySelector(".uip-page-content-frame");if(!e)return;const n=e.contentWindow.uipMasterMenu;n&&void 0!==n&&"menu"in n&&(this.menu=JSON.parse(JSON.stringify(n.menu)),this.buildMenu())},maybeFollowLink(e,n,i){if(!(e.ctrlKey||e.shiftKey||e.metaKey||1==e.button)){if(e.preventDefault(),i&&this.autoLoadIsDisabled&&n.submenu&&n.submenu.length>0)return n.open=!n.open,void(this.activeMenu=n);n.active=!0,n.submenu&&n.submenu.length>0&&(this.activeMenu=n),this.uipress.updatePage(n.url)}},returnSubIcon(e){return this.subMenuCustomIcon?this.subMenuCustomIcon:"dynamic"==this.subMenuStyle?"chevron_right":e.open||e.active?"expand_more":"chevron_left"},returnTopIcon:e=>!!e&&e.includes("uipblank")?e.replace("uipblank","favorite"):e,decodeHtmlEntities:e=>e?e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&#39;/g,"'").replace(/&nbsp;/g," ").replace(/%20/g," "):"",sepHasCustomName(e){return this.uipress.checkNestedValue(e,["custom","name"])},itemHasOpenSubMenu:e=>!!e.submenu&&(!!e.submenu.length&&(!(!e.active&&!e.open)||void 0))},template:'\n    \n          <DrillDownMenu v-if="subMenuStyle == \'dynamic\'" :menuItems="workingMenu" \n          :maybeFollowLink="maybeFollowLink" :collapsed="collapsed" :block="block"\n          :returnCollapsed="(d)=>{collapsed=d}"/>\n    \n          <div v-else class="uip-admin-menu uip-text-normal" :class="returnClasses">\n          \n            <MenuSearch v-if="hasMenuSearch && !collapsed" \n            @searching="(d)=>{searching = d}"\n            :maybeFollowLink="maybeFollowLink" :workingMenu="workingMenu"/>\n            \n            \x3c!--INLINE DROP MENU--\x3e\n            <template v-if="subMenuStyle == \'inline\' && !searching">\n            \n                <template v-for="item in workingMenu">\n                \n                  <div v-if="item.type != \'sep\'" class="uip-flex uip-flex-column uip-row-gap-xs">\n                  \n                    <TopLevelItem :item="item" :maybeFollowLink="maybeFollowLink" :collapsed="collapsed" :block="block"/>\n                    \n                    <Transition name="slide-down">\n                      <SubMenuItem v-if="itemHasOpenSubMenu(item)" :item="item" :maybeFollowLink="maybeFollowLink" :collapsed="collapsed" :block="block"/>\n                    </Transition>\n                    \n                  </div>\n                  \n                  <div v-else-if="!sepHasCustomName(item)" class="uip-margin-bottom-s uip-menu-separator"></div>\n                  \n                  <div v-else class="uip-margin-bottom-xs uip-margin-top-xs uip-flex uip-flex-row uip-gap-xxs uip-menu-separator">\n                    <span v-if="item.custom.icon && item.custom.icon != \'uipblank\'" class="uip-icon">{{item.custom.icon}}</span>\n                    <span>{{item.custom.name}}</span>\n                  </div>\n                  \n                </template>\n              \n            </template>\n            \x3c!--END INLINE DROP MENU--\x3e\n            \n            \n            \n            \x3c!--HOVER MENU--\x3e\n            <template v-if="subMenuStyle == \'hover\' && !searching">\n            \n                <template v-for="item in workingMenu">\n                \n                  <dropdown v-if="item.type != \'sep\'"  :pos="returnDropdownPosition" class="uip-flex uip-flex-column uip-row-gap-xs" \n                  :hover="true" :disableTeleport="true">\n                    \n                    <template v-slot:trigger>\n                    \n                      <TopLevelItem :item="item" :maybeFollowLink="maybeFollowLink" :collapsed="collapsed" :block="block"/>\n                      \n                    </template>\n                    \n                    <template v-if="item.submenu && item.submenu.length > 0" v-slot:content>\n                      \n                          <SubMenuItem :item="item" :maybeFollowLink="maybeFollowLink" :collapsed="collapsed" :block="block"/>\n                          \n                    </template>\n                  </dropdown>\n                  \n                  \n                  <div v-else-if="!sepHasCustomName(item)" class="uip-margin-bottom-s uip-menu-separator"></div>\n                  \n                  <div v-else class="uip-margin-bottom-xs uip-margin-top-xs uip-flex uip-flex-row uip-gap-xxs uip-menu-separator">\n                    <span v-if="item.custom.icon && item.custom.icon != \'uipblank\'" class="uip-icon">{{item.custom.icon}}</span>\n                    <span>{{item.custom.name}}</span>\n                  </div>\n                \n                  \n                </template>\n              \n            </template>\n            \n            \n            \n            \n            \n            <a ref="newTab" target="_BLANK" class="uip-hidden"></a>\n            \n            <MenuCollapse v-if="hasMenuCollapse" :collapsed="collapsed" :returnData="(d) => {collapsed = d}"/>\n            \n          </div>'};