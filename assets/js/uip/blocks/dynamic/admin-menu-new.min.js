const{__:__,_x:_x,_n:_n,_nx:_nx}=wp.i18n;export function moduleData(){return{props:{display:String,name:String,block:Object},data(){return{menu:[],activeMenu:!1,workingMenu:[],activeLink:"",breadCrumbs:[{name:__("Home","uipress-lite"),url:this.uipData.dynamicOptions.viewadmin.value}],menuSearch:"",menuSearchIndex:0,staticMenu:[],strings:{mainmenu:__("Main menu","uipress-lite"),collapseMenu:__("Collapse menu","uipress-lite"),search:__("Search menu","uipress-lite")},collapsed:!1}},inject:["uipData","uipress","uiTemplate"],watch:{breadCrumbs:{handler(e,i){let n=new CustomEvent("uip_breadcrumbs_change",{detail:{crumbs:this.breadCrumbs}});document.dispatchEvent(n)},deep:!0},collapsed:{handler(e,i){e?(document.documentElement.setAttribute("uip-menu-collapsed","true"),this.uiTemplate.menuCollapsed=!0):(document.documentElement.setAttribute("uip-menu-collapsed","false"),this.uiTemplate.menuCollapsed=!1),this.uipress.saveUserPreference("menuCollapsed",e,!1)}},menuSearch:{handler(e,i){this.menuSearchIndex=0}}},mounted(){this.setMenu(),this.buildMenu(),this.mountEventListeners(),this.uipData.userPrefs.menuCollapsed&&this.showCollapse&&(this.collapsed=!0)},computed:{isCollapsed(){return this.collapsed},hasStaticMenu(){let e=this.uipress.get_block_option(this.block,"block","customMenu");return"none"!=e&&e},subMenuStyle(){if(this.collapsed)return"hover";let e=this.uipress.get_block_option(this.block,"block","subMenuStyle");return this.uipress.isObject(e)&&"value"in e?e.value:e},subMenuCustomIcon(){let e=this.uipress.get_block_option(this.block,"block","subMenuIcon");return!!e.value&&e.value},menuAutoUpdate(){let e=this.uipress.get_block_option(this.block,"block","disableAutoUpdate");return this.uipress.isObject(e)?e.value:e},disableAutoLoad(){let e=this.uipress.get_block_option(this.block,"block","loadOnClick");return this.uipress.isObject(e)?e.value:e},showCollapse(){let e=this.uipress.get_block_option(this.block,"block","menuCollapse");return this.uipress.isObject(e)?e.value:e},showSearch(){let e=this.uipress.get_block_option(this.block,"block","showSearch");return this.uipress.isObject(e)?e.value:e},returnDropdownPosition(){let e=this.uipress.get_block_option(this.block,"block","dropdownPosition");return this.uipress.isObject(e)?e.value:""==e?"right":e},searchItems(){let e=this.menuSearch.toLowerCase(),i=[],n=this;for(let t of n.workingMenu){if("sep"==t.type)continue;if(t.name.toLowerCase().includes(e)&&i.push(t),t.submenu)for(let n of t.submenu){if("sep"==n.type)continue;n.name.toLowerCase().includes(e)&&(n.parent=t.name,i.push(n))}}return i}},beforeUnmount(){document.removeEventListener("uip_page_change",this.updateActiveLink,{once:!1}),document.removeEventListener("uip_page_change_loaded",this.updateMenuFromFrame,{once:!1})},methods:{setMenu(){this.menu=JSON.parse(JSON.stringify(this.uipData.adminMenu.menu))},mountEventListeners(){document.addEventListener("uip_page_change",this.updateActiveLink,{once:!1}),document.addEventListener("uip_page_change_loaded",this.updateMenuFromFrame,{once:!1})},updateActiveLink(e){this.activeLink=e.detail.url?e.detail.url.replaceAll("%2F","/"):e.detail.url},watchForArrows(e){switch(e.key){case"Enter":const i=document.querySelector(`#uip-menu-search-results [data-id="${this.menuSearchIndex}"]`);i&&i.click();break;case"ArrowDown":this.menuSearchIndex=this.menuSearchIndex>=this.searchItems.length-1?0:this.menuSearchIndex++;break;case"ArrowUp":this.menuSearchIndex=this.menuSearchIndex<=0?this.searchItems.length-1:this.menuSearchIndex--}},buildMenu(){const e=this.activeLink;if(!e)return this.menu;this.breadCrumbs=[{name:__("Home","uipress-lite"),url:this.uipData.dynamicOptions.viewadmin.value}];const i=i=>{i.active=!1,i.url=i.url?this.santize(i.url):void 0,i.name=i.name?this.santize(i.name):void 0,i.url===e&&(i.active=!0,this.breadCrumbs.push({name:i.name,url:i.url}))};this.menu.forEach(n=>{n.active=!1,n.url=n.url?this.santize(n.url):void 0,n.name=n.name?this.santize(n.name):void 0;const t=this.workingMenu.find(e=>e.uid===n.uid);!!t&&t.open&&(n.open=!0),n.url===e&&(n.active=!0,this.breadCrumbs.push({name:n.name,url:n.url})),n.submenu&&n.submenu.forEach(i)}),this.workingMenu=this.menu},updateMenuFromFrame(){const e=document.querySelector(".uip-page-content-frame");if(!e)return;const i=e.contentWindow.uipMasterMenu;i&&void 0!==i&&"menu"in i&&(this.menu=JSON.parse(JSON.stringify(i.menu)),this.buildMenu())},activeItem(e,i,n){if(i.ctrlKey||i.shiftKey||i.metaKey||i.button&&1==i.button)return;if(i.preventDefault(),n){if(this.disableAutoLoad&&e.submenu&&e.submenu.length>0)return e.open=!e.open,void(this.activeMenu=e);e.active=!0}let t=this;e.submenu&&e.submenu.length>0&&(this.activeMenu=e);let s=new RegExp("^(?:[a-z+]+:)?//","i"),u=e.url;if(s.test(u)||(u=this.uipData.dynamicOptions.viewadmin.value+u),e.withoutFrame){let e=new URL(u);e.searchParams.set("uip-framed-page",1),u=e.href}if(e.withoutUiPress){let i=new URL(u),n=t.uipress.createUID();i.searchParams.set("uipwf",n),i.searchParams.set("uip-framed-page",0),u=i.href;let s=new FormData;return s.append("action","uip_create_frame_switch"),s.append("security",uip_ajax.security),s.append("uid",n),void t.uipress.callServer(uip_ajax.ajax_url,s).then(i=>{e.newTab?(this.$refs.newTab.href=u,this.$refs.newTab.click(),this.$refs.newTab.href="",this.$refs.newTab.blur()):this.uipress.updatePage(u,!0)})}if(e.newTab||e.withoutFrame)return this.$refs.newTab.href=u,this.$refs.newTab.click(),this.$refs.newTab.href="",void this.$refs.newTab.blur();this.uipress.updatePage(e.url)},hideIcons(){if(this.collapsed)return!1;let e=this.uipress.checkNestedValue(this.block,["settings","block","options","hideIcons","value"]);return this.uipress.isObject(e)?e.value:e},returnDropPos(){let e=this.uipress.get_block_option(this.block,"block","menuDirection");return e&&"value"in e?"horizontal"==e.value?"bottom-left":"right":"bottom-left"},returnClasses(){let e="";return this.collapsed&&(e+=" uip-menu-collapsed"),e},returnSubIcon(e){return this.subMenuCustomIcon?this.subMenuCustomIcon:"dynamic"==this.subMenuStyle?"chevron_right":e.open||e.active?"expand_more":"chevron_left"},returnTopIcon:e=>e&&e.includes("uipblank")?e.replace("uipblank","favorite"):e,santize:e=>void 0===e?"":""==e.url?"":e.replace(/&amp;/g,"&"),collapseOptions(){return!this.activeMenu.submenu&&"dynamic"==this.subMenuStyle||(!this.activeMenu.submenu||"dynamic"!=this.subMenuStyle)},sepHasCustomName(e){return this.uipress.checkNestedValue(e,["custom","name"])}},template:'\n    \n          <div class="uip-admin-menu uip-text-normal" :class="returnClasses()">\n          \n            <div v-show="showSearch" class="uip-flex uip-menu-search uip-border-round uip-margin-bottom-s uip-flex-center" v-if="!collapsed">\n              <span class="uip-icon uip-text-muted uip-margin-right-xs uip-icon">search</span>\n              <input @keydown="watchForArrows" ref="menusearcher" class="uip-blank-input uip-flex-grow uip-text-s" type="search" :placeholder="strings.search" v-model="menuSearch">\n            </div>\n            \n            \n            <div v-if="menuSearch != \'\'" class="uip-flex uip-flex-column uip-row-gap-xxs" id="uip-menu-search-results">\n            \n              <template v-for="(item, index) in searchItems">\n              \n                  <a class="uip-flex uip-flex- uip-gap-xxxs uip-link-default uip-no-underline uip-flex-center uip-text-s uip-padding-xxxs uip-border-rounder"\n                  @click="activeItem(item, $event)"\n                  :class="menuSearchIndex == index ? \'uip-background-high-light\' : \'\'" :href="item.url" :data-id="index">\n                    \n                    <span class="uip-text-muted" v-if="item.parent">{{item.parent}}</span>\n                    <span class="uip-icon" v-if="item.parent">chevron_right</span>\n                    <span class="">{{item.name}}</span>\n                    \n                  </a>\n                \n              </template>\n            \n            </div>\n    \n            \n            \x3c!--INLINE DROP MENU--\x3e\n            <template v-if="subMenuStyle == \'inline\' && menuSearch == \'\'">\n            \n                <template v-for="item in workingMenu">\n                \n                  <div v-if="item.type != \'sep\'" class="uip-flex uip-flex-column uip-row-gap-xs">\n                  \n                    <a :href="item.url" @click="activeItem(item, $event, true)" class="uip-no-underline uip-link-default uip-top-level-item" :class="item.customClasses" :active="item.active ? true : false">\n                    \n                      <div v-if="!hideIcons()" v-html="returnTopIcon(item.icon)" class="uip-flex uip-flex-center uip-menu-icon uip-icon uip-icon-medium"></div>\n                      \n                      <div class="uip-flex-grow uip-flex uip-gap-xs uip-flex-center">\n                        <div class="uip-line-height-1" v-html="item.name"></div>\n                        <div v-if="item.notifications && item.notifications > 0" class="uip-border-round uip-h-14 uip-ratio-1-1 uip-background-secondary uip-text-inverse uip-text-xxs uip-text-bold uip-flex uip-flex-center uip-flex-middle uip-menu-notification"><span>{{item.notifications}}</span></div>\n                      </div>\n                      \n                      <div v-if="item.submenu && item.submenu.length > 0" class="uip-icon uip-link-muted">{{returnSubIcon(item)}}</div>\n                      \n                    </a>\n                    \n                    <Transition name="slide-down">\n                      <div v-if="item.submenu && (item.active || item.open) && item.submenu.length > 0" class="uip-admin-submenu">\n                      \n                          <template v-for="sub in item.submenu">\n                          \n                              <div v-if="sub.type != \'sep\'" class="uip-flex-grow uip-flex uip-gap-xs uip-flex-center">\n                                <a :href="sub.url" @click="activeItem(sub, $event)" :class="sub.customClasses" class="uip-no-underline uip-link-muted uip-sub-level-item" :active="sub.active ? true : false">{{sub.name}}</a>\n                                <div v-if="sub.notifications && sub.notifications > 0" class="uip-border-circle uip-w-14 uip-h-14 uip-ratio-1-1 uip-background-secondary uip-text-inverse uip-text-xxs uip-flex uip-flex-center uip-flex-middle uip-menu-notification"><span>{{sub.notifications}}</span></div>\n                              </div>\n                              \n                              <div v-else-if="!sepHasCustomName(sub)" class="uip-margin-bottom-s uip-menu-separator"></div>\n                              \n                              <div v-else class="uip-margin-bottom-s uip-margin-top-s uip-flex uip-flex-row uip-gap-xxs uip-menu-separator">\n                                <span v-if="sub.custom.icon && sub.custom.icon != \'uipblank\'" class="uip-icon">{{sub.custom.icon}}</span>\n                                <span>{{sub.custom.name}}</span>\n                              </div>\n                            \n                          </template>\n                          \n                      </div>\n                    </Transition>\n                  </div>\n                  \n                  <div v-else-if="!sepHasCustomName(item)" class="uip-margin-bottom-s uip-menu-separator"></div>\n                  \n                  <div v-else class="uip-margin-bottom-xs uip-margin-top-xs uip-flex uip-flex-row uip-gap-xxs uip-menu-separator">\n                    <span v-if="item.custom.icon && item.custom.icon != \'uipblank\'" class="uip-icon">{{item.custom.icon}}</span>\n                    <span>{{item.custom.name}}</span>\n                  </div>\n                \n                  \n                </template>\n              \n            </template>\n            \x3c!--END INLINE DROP MENU--\x3e\n            \n            \n            \n            \x3c!--HOVER MENU--\x3e\n            <template v-if="subMenuStyle == \'hover\' && menuSearch == \'\'">\n            \n                <template v-for="item in workingMenu">\n                \n                  <dropdown v-if="item.type != \'sep\'"  :pos="returnDropdownPosition" class="uip-flex uip-flex-column uip-row-gap-xs" :hover="true" slotClass="uip-admin-submenu" triggerClass="uip-flex uip-flex-grow uip-w-100p">\n                    \n                    <template v-slot:trigger>\n                    \n                      <a :href="item.url" @click="activeItem(item, $event, true)" class="uip-no-underline uip-link-default uip-top-level-item" :class="item.customClasses" :active="item.active ? true : false">\n                      \n                        <div v-if="!hideIcons()" v-html="returnTopIcon(item.icon)" class="uip-flex uip-flex-center uip-menu-icon uip-icon uip-icon-medium"></div>\n                        \n                        <div v-if="!collapsed" class="uip-flex-grow uip-flex uip-gap-xs uip-flex-center">\n                          <div v-html="item.name"></div>\n                          <div v-if="item.notifications && item.notifications > 0" class="uip-border-round uip-h-14 uip-ratio-1-1 uip-background-secondary uip-text-inverse uip-text-xxs uip-text-bold uip-flex uip-flex-center uip-flex-middle uip-menu-notification"><span>{{item.notifications}}</span></div>\n                        </div>\n                        \n                        \n                      </a>\n                      \n                    </template>\n                    \n                    <template v-if="item.submenu && item.submenu.length > 0" v-slot:content>\n                      \n                          <template v-for="sub in item.submenu">\n                          \n                              <div v-if="sub.type != \'sep\'" class="uip-flex-grow uip-flex uip-gap-xs uip-flex-center">\n                                <a :href="sub.url" @click="activeItem(sub, $event)" :class="sub.customClasses" class="uip-no-underline uip-link-default uip-sub-level-item" :active="sub.active ? true : false">{{sub.name}}</a>\n                                <div v-if="sub.notifications && sub.notifications > 0" class="uip-border-circle uip-w-14 uip-h-14 uip-ratio-1-1 uip-background-secondary uip-text-inverse uip-text-xxs uip-flex uip-flex-center uip-flex-middle uip-menu-notification"><span>{{sub.notifications}}</span></div>\n                              </div>\n                              \n                              <div v-else-if="!sepHasCustomName(sub)" class="uip-margin-bottom-s uip-menu-separator"></div>\n                              \n                              <div v-else class="uip-margin-bottom-s uip-margin-top-s uip-flex uip-flex-row uip-gap-xxs uip-menu-separator">\n                                <span v-if="sub.custom.icon && sub.custom.icon != \'uipblank\'" class="uip-icon">{{sub.custom.icon}}</span>\n                                <span>{{sub.custom.name}}</span>\n                              </div>\n                            \n                          </template>\n                          \n                    </template>\n                  </dropdown>\n                  \n                  \n                  <div v-else-if="!sepHasCustomName(item)" class="uip-margin-bottom-s uip-menu-separator"></div>\n                  \n                  <div v-else class="uip-margin-bottom-xs uip-margin-top-xs uip-flex uip-flex-row uip-gap-xxs uip-menu-separator">\n                    <span v-if="item.custom.icon && item.custom.icon != \'uipblank\'" class="uip-icon">{{item.custom.icon}}</span>\n                    <span>{{item.custom.name}}</span>\n                  </div>\n                \n                  \n                </template>\n              \n            </template>\n            \x3c!--END INLINE DROP MENU--\x3e\n            \n            \n            \n            \x3c!--DYNAMIC MENU--\x3e\n            <template v-if="subMenuStyle == \'dynamic\' && menuSearch == \'\'">\n                \n                <TransitionGroup name="slide-left">\n                \n                  <template v-if="activeMenu == false" v-for="item in workingMenu">\n                  \n                    <div v-if="item.type != \'sep\'" class="uip-flex uip-flex-column uip-row-gap-xs">\n                    \n                      <a :href="item.url" @click="activeItem(item, $event, true)" class="uip-no-underline uip-link-default uip-top-level-item" :class="item.customClasses" :active="item.active ? true : false">\n                      \n                        <div v-if="!hideIcons()" v-html="returnTopIcon(item.icon)" class="uip-flex uip-flex-center uip-menu-icon uip-icon uip-icon-medium"></div>\n                        \n                        <div class="uip-flex-grow uip-flex uip-gap-xs uip-flex-center">\n                          <div class="uip-line-height-1" v-html="item.name"></div>\n                          <div v-if="item.notifications && item.notifications > 0" class="uip-border-round uip-h-14 uip-ratio-1-1 uip-background-secondary uip-text-inverse uip-text-xxs uip-text-bold uip-flex uip-flex-center uip-flex-middle uip-menu-notification"><span>{{item.notifications}}</span></div>\n                        </div>\n                        \n                        <div v-if="item.submenu && item.submenu.length > 0" class="uip-icon uip-link-muted">{{returnSubIcon(item, true)}}</div>\n                        \n                      </a>\n                      \n                    </div>\n                    \n                    <div v-else-if="!sepHasCustomName(item)" class="uip-margin-bottom-s uip-menu-separator"></div>\n                    \n                    <div v-else class="uip-margin-bottom-xs uip-margin-top-xs uip-flex uip-flex-row uip-gap-xxs uip-menu-separator">\n                      <span v-if="item.custom.icon && item.custom.icon != \'uipblank\'" class="uip-icon">{{item.custom.icon}}</span>\n                      <span>{{item.custom.name}}</span>\n                    </div>\n                  \n                    \n                  </template>\n                  \n                </TransitionGroup>\n                \n                \n                <Transition name="slide-right">\n                  <div v-if="activeMenu.submenu && activeMenu.submenu.length > 0" class="uip-admin-submenu">\n                  \n                      \n                      <div class="uip-flex uip-gap-xxs uip-flex-center uip-flex-row uip-flex-center uip-text-bold uip-text-l uip-sub-menu-header uip-margin-bottom-s uip-gap-xxs" @click="activeMenu = false">\n                        <div class="uip-icon uip-icon-medium">arrow_back</div>\n                        <div class="uip-flex-grow" v-html="activeMenu.name"></div>\n                      </div>\n                  \n                      <template v-for="sub in activeMenu.submenu">\n                      \n                          <div v-if="sub.type != \'sep\'" class="uip-flex-grow uip-flex uip-gap-xs uip-flex-center">\n                            <a :href="sub.url" @click="activeItem(sub, $event)" :class="sub.customClasses" class="uip-no-underline uip-link-muted uip-sub-level-item" :active="sub.active ? true : false">{{sub.name}}</a>\n                            <div v-if="sub.notifications && sub.notifications > 0" class="uip-border-circle uip-w-14 uip-h-14 uip-ratio-1-1 uip-background-secondary uip-text-inverse uip-text-xxs uip-flex uip-flex-center uip-flex-middle uip-menu-notification"><span>{{sub.notifications}}</span></div>\n                          </div>\n                          \n                          <div v-else-if="!sepHasCustomName(sub)" class="uip-margin-bottom-s uip-menu-separator"></div>\n                          \n                          <div v-else class="uip-margin-bottom-s uip-margin-top-s uip-flex uip-flex-row uip-gap-xxs uip-menu-separator">\n                            <span v-if="sub.custom.icon && sub.custom.icon != \'uipblank\'" class="uip-icon">{{sub.custom.icon}}</span>\n                            <span>{{sub.custom.name}}</span>\n                          </div>\n                        \n                      </template>\n                      \n                  </div>\n                </Transition>\n              \n            </template>\n            \x3c!--END DYNAMIC--\x3e\n            \n            \n            \n            \n            \n            <a ref="newTab" target="_BLANK" class="uip-hidden"></a>\n            \n            \n            \n            <div v-if="showCollapse && collapseOptions()" class="uip-flex uip-flex-row uip-gap-xs uip-flex-center uip-link-muted uip-margin-top-s uip-menu-collapse" @click="collapsed = !collapsed">\n              <div v-if="collapsed" class="uip-icon uip-text-">arrow_forward_ios</div>\n              <div v-if="!collapsed" class="uip-icon uip-text-">arrow_back_ios</div>\n              <div v-if="!collapsed">{{strings.collapseMenu}}</div>\n            </div>\n            \n          </div>'}};