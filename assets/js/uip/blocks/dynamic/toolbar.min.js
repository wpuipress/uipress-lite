const{__:__,_x:_x,_n:_n,_nx:_nx}=wp.i18n;export function moduleData(){return{props:{display:String,name:String,block:Object},data:function(){return{toolbar:{},rendered:!1}},inject:["uipData","uipress","uiTemplate"],watch:{"uipData.toolbar":{handler(e,t){},deep:!0}},mounted:function(){let e=this;this.dequeueAdminBarStyles(),this.toolbar=JSON.parse(JSON.stringify(this.uipData.toolbar)),requestAnimationFrame(()=>{e.updateFromDom()}),document.addEventListener("uip_page_change_loaded",t=>{e.updateToolBarFromFrame(),setTimeout(function(){e.updateQM(),e.updateFromDom()},100)},{once:!1}),requestAnimationFrame(()=>{this.rendered=!0})},computed:{getHidden(){let e=this.block.settings.block.options.hiddenToolbarItems.value;return this.uipress.isObject(e)?[]:e},returnToolbar(){return this.toolbar},returnDropdownPosition(){let e=this.uipress.get_block_option(this.block,"block","dropdownPosition");return this.uipress.isObject(e)?e.value:""==e?"bottom-left":e},returnSubDropdownPosition(){let e=this.uipress.get_block_option(this.block,"block","subDropdownPosition");return this.uipress.isObject(e)?e.value:""==e?"right":e}},methods:{dequeueAdminBarStyles(){let e=document.querySelector('link[href*="load-styles.php?"]');if(e){let t=e.href.replace("admin-bar,","");setTimeout(()=>{e.href=t},100)}},updateFromDom(){let e,t=this,i=document.getElementsByClassName("uip-page-content-frame");i[0]?e=i[0].contentWindow.document:(e=document,console.log("helloooo"));let n=e.getElementById("wp-admin-bar-root-default"),o=e.getElementById("wp-admin-bar-top-secondary");if(!n)return;let r=n.children,u=o.children;var a=[];a=Array.prototype.concat.apply(a,r),a=Array.prototype.concat.apply(a,u);let s=t.uipData.options.adminURL,l=t.uipData.options.domain,p=s.replace(l,"");for(const e of a){let i=e.getAttribute("id");if(i&&(!((i=i.replace("wp-admin-bar-",""))in t.toolbar)&&"site-name"!=i&&"menu-toggle"!=i&&"app-logo"!=i&&"my-account"!=i)){let n={id:"attr",group:"",meta:[],parent:"",submenu:{},title:"",href:""},o=e.querySelector("a.ab-item");if(o){let e=o.getAttribute("href");e&&e.startsWith(p)&&(e=e.replace(p,s)),n.href=e,n.title=o.innerHTML}let r=e.querySelector(".ab-sub-wrapper .ab-submenu");if(r)for(const e of r.children){let t=e.getAttribute("id");if(!t)continue;t=t.replace("wp-admin-bar-","");let o=e.querySelector("a.ab-item"),r={id:i,group:"",meta:[],parent:i,submenu:{},title:"",href:""};if(o){let e=o.getAttribute("href");e&&e.startsWith(p)&&(e=e.replace(p,s)),r.href=e,r.title=o.innerHTML}n.submenu[t]=r}t.toolbar[i]=n}}},updateQM(){let e=this;if(!("query-monitor"in e.toolbar))return;let t=document.getElementsByClassName("uip-page-content-frame");if(!t[0])return;let i=t[0].contentWindow.document.getElementById("wp-admin-bar-query-monitor");if(!i)return;let n=i.getElementsByClassName("ab-label");e.toolbar["query-monitor"].title=n[0].outerHTML,e.toolbar["query-monitor"].frameLink=!0,i.classList.contains("qm-warning")&&(e.toolbar["query-monitor"].title+='<span class="uip-display-inline-block uip-border-circle uip-w-8 uip-ratio-1-1 uip-background-red uip-margin-left-xxs"></span>'),(i.classList.contains("qm-alert")||i.classList.contains("qm-notice")||i.classList.contains("qm-deprecated")||i.classList.contains("qm-strict")||i.classList.contains("qm-expensive"))&&(e.toolbar["query-monitor"].title+='<span class="uip-display-inline-block uip-border-circle uip-w-8 uip-ratio-1-1 uip-background-orange uip-margin-left-xxs"></span>');let o=i.querySelectorAll("#wp-admin-bar-query-monitor-default > li"),r={};for(let e of o){let t=e.getAttribute("id"),i=t.replace("wp-admin-bar-query-monitor-",""),n=e.querySelector("a"),o=n.getAttribute("href"),u=n.textContent;r[i]={group:"",href:o,id:t,meta:[],parent:"query-monitor",submenu:{},title:u,frameLink:!0}}e.toolbar["query-monitor"].submenu=r},updateToolBarFromFrame(){let e=document.getElementsByClassName("uip-page-content-frame"),t=this;if(e[0]){let i=e[0];if(i.contentWindow.uipMasterToolbar&&void 0!==i.contentWindow.uipMasterToolbar){let e=i.contentWindow.uipMasterToolbar;Array.isArray(e)||(t.toolbar=JSON.parse(JSON.stringify(e)))}}},ifHiden(e){return!this.getHidden.includes(e)},customIcon(e){let t=this.uipress.get_block_option(this.block,"block","editToolbarItems");if(!this.uipress.isObject(t))return!1;if(e in t){let i=t[e].icon;if(""!=i)return i}return!1},customTitle(e){let t=this.uipress.get_block_option(this.block,"block","editToolbarItems");if(!this.uipress.isObject(t))return!1;if(Object.hasOwn(t,e)){let i=t[e].title;if(""!=i)return i}return!1},updatePage(e,t,i){if(!(t.ctrlKey||t.shiftKey||t.metaKey||t.button&&1==t.button))if(t.preventDefault(),e.frameLink){let t=document.getElementsByClassName("uip-page-content-frame");if(!t[0])return;let i=t[0].contentWindow.document.querySelector("#"+e.id+" a");i&&i.click()}else i?this.uipress.updatePage(this.formatHREF(e.href),i):this.uipress.updatePage(this.formatHREF(e.href))},formatHREF(e){let t=this.uipData.options.adminURL,i=this.uipData.options.domain,n=t.replace(i,"");return e&&e.startsWith(n)&&(e=e.replace(n,t)),e}},template:'\n            <div class="uip-text-normal" v-if="rendered">\n            \n            \n              <component is="style">\n                .uip-admin-toolbar #wpadminbar {all:unset}\n                .uip-admin-toolbar #wpadminbar .ab-icon {font-size:18px; filter: contrast(0.6);}\n              </component>\n              \n              <div id="wpadminbar" style="display: block !important;">\n              \n                <div class="uip-admin-toolbar uip-flex">\n                  <template v-for="item in returnToolbar">\n                  \n                    <div class="" v-if="ifHiden(item.id)" :id="\'wp-admin-bar-\' + item.id" :class="item.meta.class">\n                      \x3c!--FIRST DROP --\x3e\n                      <dropdown :hover="true" :pos="returnDropdownPosition">\n                        <template v-slot:trigger>\n                        \n                          <a :href="formatHREF(item.href)" @click="updatePage(item, $event)" class="uip-link-default uip-no-underline uip-toolbar-top-item uip-flex uip-gap-xs uip-flex-center">\n                            <div class="uip-icon uip-toolbar-top-item-icon uip-text-l" v-if="customIcon(item.id)">{{customIcon(item.id)}}</div>\n                            \n                            <component v-if="customIcon(item.id)" is="style" scoped>\n                              #{{\'wp-admin-bar-\' + item.id}} .ab-icon{display:none}\n                            </component>\n                            \n                            <div class="uip-line-height-1 uip-flex uip-gap-xxs" v-if="customTitle(item.id)">{{customTitle(item.id)}}</div>\n                            <div class="uip-line-height-1 uip-flex uip-gap-xxs uip-flex-center" v-if="!customTitle(item.id)" v-html="item.title"></div>\n                          </a>\n                        </template>\n                        <template v-slot:content v-if="item.submenu && Object.keys(item.submenu).length > 0">\n                        \n                          <div class="uip-toolbar-submenu uip-min-w-200 uip-border-rounder uip-padding-xs">\n                          \n                          \n                            \x3c!-- NETWORK ADMIN TOOLBAR --\x3e\n                            <template v-if="item.id == \'my-sites\'" v-for="subsection in item.submenu">\n                              <div class="uip-padding-xxs uip-flex uip-flex-column uip-row-gap-xxs uip-min-w-130">\n                                <template v-for="sub in subsection.submenu">\n                                  \x3c!--SECOND DROP --\x3e\n                                <dropdown width="200" :hover="true">\n                                    <template v-slot:trigger>\n                                      <a :href="formatHREF(sub.href)" @click="updatePage(sub, $event, true)"  class="uip-link-default uip-no-underline uip-toolbar-sub-item uip-flex uip-flex-center uip-flex-between uip-gap-s uip-flex-grow uip-padding-xxs uip-border-rounder hover:uip-background-muted" >\n                                        <span v-html="sub.title"></span>\n                                        <span v-if="sub.submenu" class="uip-icon">chevron_right</span>\n                                      </a>\n                                    </template>\n                                    <template v-slot:content v-if="sub.submenu">\n                                      <div class="uip-toolbar-submenu uip-min-w-200 uip-padding-xs">\n                                        <template v-for="subsub in sub.submenu">\n                                          <a :href="formatHREF(subsub.href)" @click="updatePage(subsub, $event, true)"  class="uip-link-default uip-no-underline uip-toolbar-sub-item uip-flex uip-flex-center uip-flex-between uip-gap-s uip-flex-grow uip-padding-xxs uip-border-rounder hover:uip-background-muted" v-html="subsub.title"></a>\n                                        </template>\n                                      </div>\n                                    </template>\n                                  </dropdown>\n                                  \x3c!--END SECOND DROP --\x3e\n                                </template>\n                              </div>\n                              <div v-if="subsection.id == \'my-sites-super-admin\'" class="uip-border-bottom"></div>                            </template>\n                            \x3c!-- END NETWORK ADMIN TOOLBAR --\x3e\n                            \n                            \n                            <template  v-else v-for="sub in item.submenu">\n                              \x3c!--SECOND DROP --\x3e\n                              <dropdown width="200" :pos="returnSubDropdownPosition" triggerClass="uip-flex uip-flex-grow" :hover="true">\n                                <template v-slot:trigger>\n                                  <a @click="updatePage(sub, $event)" :href="formatHREF(sub.href)" class="uip-link-default uip-no-underline uip-toolbar-sub-item uip-flex uip-flex-center uip-flex-between uip-gap-s uip-flex-grow uip-padding-xxs uip-border-rounder hover:uip-background-muted" >\n                                    <span v-html="sub.title"></span>\n                                    <span v-if="Object.keys(sub.submenu).length > 0" class="uip-icon">chevron_right</span>\n                                  </a>\n                                </template>\n                                <template v-slot:content v-if="Object.keys(sub.submenu).length > 0">\n                                  <div class="uip-toolbar-submenu uip-min-w-200 uip-padding-xs">\n                                    <template v-for="subsub in sub.submenu">\n                                      <a @click="updatePage(subsub, $event)" :href="formatHREF(subsub.href)" class="uip-link-default uip-no-underline uip-toolbar-sub-item uip-flex uip-flex-center uip-flex-between uip-gap-s uip-flex-grow uip-padding-xxs uip-border-rounder hover:uip-background-muted" v-html="subsub.title"></a>\n                                    </template>\n                                  </div>\n                                </template>\n                              </dropdown>\n                              \x3c!--END SECOND DROP --\x3e\n                            </template>\n                          </div>\n                        </template>\n                      </dropdown>\n                      \x3c!--END FIRST DROP --\x3e\n                      \n                    </div>\n                  </template>\n                </div>\n              \n              </div>\n              \n            </div>'}};