import{nextTick}from"../../libs/vue-esm.js";export default{props:{position:String,overlayStyle:String,style:[String,Object],shortCut:[Boolean,String,Array],closeOnLoad:[Boolean,Object]},data:()=>({open:!1}),inject:["uiTemplate"],mounted(){this.mountShortcut()},beforeUnmount(){document.removeEventListener("uipress/app/page/load/finish",this.handlePageChange,{once:!1}),window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp)},methods:{mountShortcut(){document.addEventListener("uipress/app/page/load/finish",this.handlePageChange,{once:!1}),this.shortCut&&(this.pressedKeys=new Set,this.shortcut=[...this.shortCut],window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp))},handleKeyDown(i){this.pressedKeys.add(i.key),this.shortcut.every(i=>this.pressedKeys.has(i))&&this.show()},handleKeyUp(){this.pressedKeys.clear()},handlePageChange(i){this.open&&this.closeOnLoad&&this.closeOffcanvas()},closeOffcanvas(){let i;i=this.uiTemplate&&"prod"!=this.uiTemplate.display?document.getElementById("uip-template-body"):document.body,"push"==this.overlayStyle&&(i.style.left="0",i.style.right="0"),this.$refs.offCanvasCover.classList.remove("uip-fade-in"),this.$refs.offCanvasCover.classList.add("uip-fade-out"),this.$refs.offCanvasBody.classList.remove("uip-slide-in-left"),"left"==this.position?this.$refs.offCanvasBody.classList.add("uip-slide-out-left"):this.$refs.offCanvasBody.classList.add("uip-slide-out-right"),setTimeout(()=>{this.open=!1},200)},show(){this.openOffCanvas()},close(){this.closeOffcanvas()},async openOffCanvas(){if(this.open=!0,"push"!=this.overlayStyle)return;await nextTick();let i,e=this.$refs.offCanvasBody.getBoundingClientRect().width;i="prod"!=this.uiTemplate.display?document.getElementById("uip-template-body"):document.body,"left"==this.position?(i.style.position="relative",i.style.left=e+"px"):(i.style.position="relative",i.style.left="-"+e+"px")}},template:'\n    <div>\n    \n      <div @click="openOffCanvas()">\n        <slot name="trigger"></slot>\n      </div>\n    \n      <component is="style">\n        #wpadminbar{z-index:8;}\n      </component>\n    \n      <div ref="offCanvasCover" v-if="open && overlayStyle != \'push\'" class="uip-position-fixed uip-w-100p uip-top-0 uip-bottom-0 uip-text-normal uip-flex uip-fade-in" style="background:rgba(0,0,0,0.3);z-index:9;top:0;left:0;right:0;max-height:100%">\n      \n        <div class="uip-flex uip-w-100p uip-h-100p" :class="{\'uip-flex-reverse\': position == \'left\'}">\n        \n          <div class="uip-flex-grow" @click="closeOffcanvas()"></div>\n          \n          <div ref="offCanvasBody" class="uip-w-30p uip-background-default uip-padding-m  uip-overflow-auto uip-border-box uip-offcanvas-panel uip-position-relative" :class="[{\'uip-slide-in-right\' : position == \'right\'}, {\'uip-slide-in-left\' : position == \'left\'}]" style="max-height: 100%;min-height: 100%;" :style="style">\n          \n            <div class="uip-position-absolute uip-top-0 uip-padding-s uip-right-0 uip-z-index-1">\n              <span @click="closeOffcanvas()" class="uip-icon uip-padding-xxs uip-border-round hover:uip-background-grey uip-cursor-pointer uip-link-muted uip-text-l">\n                close\n              </span>\n            </div>\n            \n            <div class="uip-position-relative uip-h-100p uip-flex uip-w-100p uip-flex uip-max-h-100p">\n              <slot name="content"></slot>\n            </div>\n            \n          </div>\n          \n        </div>\n        \n      </div>\n    \n    \n      \x3c!-- Offcanvas push --\x3e\n      <div ref="offCanvasCover" v-else-if="open && overlayStyle == \'push\'" class="uip-position-fixed uip-w-100p uip-top-0 uip-bottom-0 uip-text-normal uip-flex" style="top:0;left:0;right:0;max-height:100%">\n      \n        <div class="uip-flex uip-w-100p uip-h-100p" :class="{\'uip-flex-reverse\': position == \'left\'}">\n        \n          <div class="uip-flex-grow" @click="closeOffcanvas()"></div>\n          \n          <div ref="offCanvasBody" class="uip-w-30p uip-background-default uip-padding-m  uip-overflow-auto uip-border-box uip-offcanvas-panel uip-position-relative" :class="[{\'uip-slide-in-right\' : position == \'right\'}, {\'uip-slide-in-left\' : position == \'left\'}]" style="max-height: 100%;min-height: 100%;" :style="style">\n          \n            <div class="uip-position-absolute uip-top-0 uip-padding-s uip-right-0 uip-z-index-1">\n              <span @click="closeOffcanvas()" class="uip-icon uip-padding-xxs uip-border-round hover:uip-background-grey uip-cursor-pointer uip-link-muted uip-text-l">\n                close\n              </span>\n            </div>\n            \n            <div class="uip-position-relative uip-h-100p uip-flex uip-w-100p uip-flex uip-max-h-100p">\n              <slot name="content"></slot>\n            </div>\n            \n          </div>\n          \n        </div>\n        \n      </div>\n    \n    </div>\n    \n    '};