import Axios from"../libs/axios.min.js";const{__:__,_x:_x,_n:_n,_nx:_nx}=wp.i18n;import{defineAsyncComponent}from"../../../libs/vue-esm.js";export const MediaLibrary={emits:["image-selected","cancel-select"],data:()=>({loading:!0,strings:{mediaLibrary:__("Media library","uipress-lite"),select:__("Select","uipress-lite"),cancel:__("Cancel","uipress-lite"),search:__("Search","uipress-lite"),nothingFound:__("Nothing found for search term","uipress-lite"),altText:__("Alt text","uipress-lite"),caption:__("Caption","uipress-lite"),aNicePhoto:__("A nice image","uipress-lite"),aNicePhotoDescription:__("A image caption","uipress-lite"),title:__("Title","uipress-lite"),imageTitle:__("Image title","uipress-lite"),photoBy:__("Photo by","uipress-lite"),on:__("on","uipress-lite"),size:__("Size","uipress-lite")},returnSize:"full",activeTab:"library",tabs:{library:{value:"library",label:__("Library","uipress-lite")},unsplash:{value:"unsplash",label:__("Unsplash","uipress-lite")},upload:{value:"upload",label:__("Upload","uipress-lite")}},media:[],unsplashMedia:[],restUrl:uip_ajax.rest_url,search:"",total:0,perPage:20,selected:!1,validDrop:!1}),watch:{activeTab:{handler(t,e){this.maybeGetMedia()},deep:!0},selected:{handler(t,e){t&&"caption"in this.selected&&(this.selected.caption.rendered=this.stripHTML(this.selected.caption.rendered))},deep:!0}},mounted(){this.maybeGetMedia()},computed:{ifDisabled(){return!this.selected}},methods:{maybeGetMedia(t){"unsplash"==this.activeTab&&this.getUnsplashMedia(t),"library"==this.activeTab&&this.getMedia(t)},async getUnsplashMedia(t){let e="https://api.uipress.co/unsplash/?key=0e49uptg-aw[e0ifjhiljsoevjhbsoe8gilplhirlvi";this.perPage;this.search&&(e+=`&s=${this.search}`),t||(this.loading=!0),await Axios({method:"get",url:e}).then(t=>{this.unsplashMedia=t.data,this.loading=!1}).catch(t=>{this.media=[{error:!0,message:t.message,code:t.error}],this.total=0,this.loading=!1})},async getMedia(t){let e=this.restUrl+"wp/v2/media",i={status:"inherit",per_page:this.perPage,media_type:"image"};this.search&&(i.search=this.search),t||(this.loading=!0),await Axios({method:"get",url:e,headers:uip_ajax.rest_headers,params:i}).then(t=>{this.media=t.data,this.total=t.headers["x-wp-total"],this.loading=!1}).catch(t=>{this.media=[{error:!0,message:t.message,code:t.error}],this.total=0,this.loading=!1})},async updateMedia(){let t=this.restUrl+`wp/v2/media/${this.selected.id}`,e={alt_text:this.selected.alt_text,title:this.selected.title.rendered,caption:this.selected.caption.rendered};Axios({method:"post",url:t,headers:uip_ajax.rest_headers,data:e}).then(t=>{this.uipApp.notifications.notify(__("Image saved","uipress-lite"),"","success",!0)}).catch(t=>{this.uipApp.notifications.notify(t.message,"","error",!0)})},async uploadImages(t,e){this.validDrop=!1;let i,s=this.restUrl+"wp/v2/media/",n=this.uipApp.notifications.notify(__("Uploading images","uipress-lite"),"","default",!0,!0);e&&(i=Array.from(t.dataTransfer.files)),e||(i=Array.from(event.target.files));for(const t of i){const e=new FormData;e.append("file",t,t.name);try{await Axios({method:"post",url:s,headers:{...uip_ajax.rest_headers,"Content-Disposition":`attachment; filename="${t.name}"`,"Content-Type":t.type},data:e})}catch(e){this.uipApp.notifications.notify(__("Failed to upload","uipress-lite")+" "+t.name,"","error",!0)}}this.uipApp.notifications.remove(n),this.uipApp.notifications.notify(__("uploaded complete","uipress-lite"),"","success",!0),this.activeTab="library",this.getMedia()},importFromUnsplash(){let t=this.selected.urls.regular,e=this.restUrl+"wp/v2/media/",i=this.uipApp.notifications.notify(__("Importing image to library","uipress-lite"),"","default",!0,!0);Axios.get(t,{responseType:"blob"}).then(t=>{const i=t.data,s=new FormData;return s.append("file",i,this.selected.user.username+".jpg"),Axios({method:"post",url:e,headers:{...uip_ajax.rest_headers,"Content-Disposition":`attachment; filename="${this.selected.user.username}.jpg"`,"Content-Type":i.type},data:s})}).then(t=>{this.$emit("image-selected",t.data),this.uipApp.notifications.remove(i)}).catch(t=>{this.uipApp.notifications.notify(__("Failed to import image","uipress-lite"),"","error",!0)})},returnColumnItems:(t,e=0)=>t.filter((t,i)=>(i-e)%3==0),confirm(){this.selected.color?this.importFromUnsplash():this.$emit("image-selected",this.returnImage())},returnImage(){return{id:this.selected.id,caption:this.selected.caption.rendered,alt:this.selected.alt_text,height:this.selected.media_details.sizes[this.returnSize].height,width:this.selected.media_details.sizes[this.returnSize].width,source_url:this.selected.media_details.sizes[this.returnSize].source_url}},onScrollMedia({target:{scrollTop:t,clientHeight:e,scrollHeight:i}}){t+e>=i-1&&this.total>this.media.length&&(this.perPage+=20,this.getMedia(!0))},stripHTML(t){if(t)return t=t.replace(/(<([^>]+)>)/gi,"")},returnRatio:t=>`aspect-ratio: ${t.width} / ${t.height}`,returnImagePreview:t=>"sizes"in t.media_details?"medium"in t.media_details.sizes?t.media_details.sizes.medium.source_url:"small"in t.media_details.sizes?t.media_details.sizes.small.source_url:"thumbnail"in t.media_details.sizes?t.media_details.sizes.thumbnail.source_url:"large"in t.media_details.sizes?t.media_details.sizes.large.source_url:"full"in t.media_details.sizes?t.media_details.sizes.full.source_url:void 0:t.source_url},template:'\n    \n    <div class="uip-flex uip-flex-column uip-row-gap-s uip-flex-grow" style="overflow:hidden">\n\t\n\t\t  \n\t\t  <toggle-switch :activeValue="activeTab" :options="tabs" :returnValue="(d) => {activeTab = d}"/>\n\t\t  \n\t\t  <div v-if="loading" class="uip-padding-s uip-flex uip-flex-middle uip-flex-center uip-flex-grow">\n\t\t\t<loading-chart/>\n\t\t  </div>\n\t\t  \n\t\t  \n\t\t  \n\t\t  <div v-else-if="activeTab == \'upload\'" class="uip-flex-grow">\n\t\t  \n\t\t\t<label @drop.prevent="uploadImages($event, true)"\n\t\t\t@dragenter.prevent="validDrop = true"\n\t\t\t@dragleave.prevent="validDrop = false"\n\t\t\t@dragover.prevent="validDrop = true"\n\t\t\t:class="{\'uip-background-primary-wash\' : validDrop, \'uip-background-muted\' : !validDrop,  }"\n\t\t\tclass="uip-background-muted uip-border uip-border-rounder uip-padding-m uip-flex uip-flex-middle uip-flex-center uip-transition-all uip-link-muted">\n\t\t\t  \n\t\t\t  <span class="uip-icon uip-text-xl">file_upload</span>\n\t\t\t  <input hidden accept="image/*" type="file" multiple id="uip-import-layout" @change="uploadImages($event)">\n\t\t\t  \n\t\t\t</label>\n\t\t  \n\t\t  </div>\n\t\t  \n\t\t  \n\t\t  \n\t\t  <div v-else-if="activeTab == \'unsplash\'" class="uip-flex uip-flex-column uip-row-gap-s uip-flex-grow uip-max-h-100p uip-overflow-hidden">\n\t\t\t\n\t\t\t<div class="uip-background-muted uip-border-rounder uip-padding-xs uip-flex uip-flex-gap-s uip-flex-center">\n\t\t\t  <input class="uip-blank-input uip-flex-grow uip-text-s" type="text" v-model="search" @input="maybeGetMedia(true)" :placeholder="strings.search"> \n\t\t\t  <span class="uip-icon uip-text-muted uip-text-s">search</span>\n\t\t\t</div>\n\t\t\t\n\t\t\t<div v-if="media.length < 1 && search != \'\' && activeTab == \'library\'" class="uip-text-muted">\n\t\t\t  {{strings.nothingFound}} <strong>{{search}}</strong>\n\t\t\t</div>\n\t\t\t\n\t\t\t<div v-if="unsplashMedia.length < 1 && search != \'\' && activeTab == \'unsplash\'" class="uip-text-muted">\n\t\t\t  {{strings.nothingFound}} <strong>{{search}}</strong>\n\t\t\t</div>\n\t\t\t\n\t\t\t<template v-for="(error, index) in media">\n\t\t\t  <div v-if="error.error" class="uip-border-rounder uip-padding-xs uip-padding-left-xs  uip-background-orange-wash uip-text-s">\n\t\t\t\t{{error.message}}\n\t\t\t  </div>\n\t\t\t</template>\n\t\t\t\n\t\t\t<div class="uip-grid-col-3 uip-grid-gap-s uip-overflow-auto uip-max-w-100p uip-flex-grow uip-max-h-100p">\n\t\t\t  \n\t\t\t  \x3c!--Column 1--\x3e\n\t\t\t  <div class="uip-flex uip-flex-column uip-row-gap-s">\n\t\t\t\t<template v-for="(photo, index) in returnColumnItems(unsplashMedia, 0)">\n\t\t\t\t  <div v-if="!photo.error" \n\t\t\t\t  @click="selected = photo"\n\t\t\t\t  class="uip-flex uip-flex-column uip-flex-no-wrap uip-row-gap-xxs uip-cursor-pointer uip-position-relative">\n\t\t\t\t\t\n\t\t\t\t\t<img key="image" :src="photo.urls.small" \n\t\t\t\t\t:style="returnRatio(photo)"\n\t\t\t\t\tclass="uip-w-100p uip-max-w-100p uip-border-rounder" :alt="photo.alt_description"\n\t\t\t\t\t:class="{\'uip-brightness-05\' : photo.id == selected.id}">\n\t\t\t\t\t\n\t\t\t\t\t<div class="uip-position-absolute uip-padding-xs" v-if="photo.id == selected.id">\n\t\t\t\t\t  <div class="uip-border-circle uip-padding-xxxs uip-background-primary uip-active-outline uip-text-xs">\n\t\t\t\t\t   <span class="uip-icon uip-text-inverse">done</span>\n\t\t\t\t\t  </div> \n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<span class="uip-text-s uip-text-muted uip-max-w-100p uip-overflow-hidden uip-no-wrap uip-text-ellipsis">{{ photo.user.name }}</span>\n\t\t\t\t  </div>\n\t\t\t\t</template>\n\t\t\t  </div>\n\t\t\t  \n\t\t\t  \x3c!--Column 2--\x3e\n\t\t\t  <div class="uip-flex uip-flex-column uip-row-gap-s">\n\t\t\t\t<template v-for="(photo, index) in returnColumnItems(unsplashMedia, 1)">\n\t\t\t\t  <div v-if="!photo.error" \n\t\t\t\t  @click="selected = photo"\n\t\t\t\t  class="uip-flex uip-flex-column uip-flex-no-wrap uip-row-gap-xxs uip-cursor-pointer uip-position-relative">\n\t\t\t\t\t\n\t\t\t\t\t<img key="image" :src="photo.urls.small" \n\t\t\t\t\t:style="returnRatio(photo)"\n\t\t\t\t\tclass="uip-w-100p uip-max-w-100p uip-border-rounder" :alt="photo.alt_description"\n\t\t\t\t\t:class="{\'uip-brightness-05\' : photo.id == selected.id}">\n\t\t\t\t\t\n\t\t\t\t\t<div class="uip-position-absolute uip-padding-xs" v-if="photo.id == selected.id">\n\t\t\t\t\t  <div class="uip-border-circle uip-padding-xxxs uip-background-primary uip-active-outline uip-text-xs">\n\t\t\t\t\t   <span class="uip-icon uip-text-inverse">done</span>\n\t\t\t\t\t  </div> \n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<span class="uip-text-s uip-text-muted uip-max-w-100p uip-overflow-hidden uip-no-wrap uip-text-ellipsis">{{ photo.user.name }}</span>\n\t\t\t\t  </div>\n\t\t\t\t</template>\n\t\t\t  </div>\n\t\t\t  \n\t\t\t  \x3c!--Column 3--\x3e\n\t\t\t  <div class="uip-flex uip-flex-column uip-row-gap-s">\n\t\t\t\t<template v-for="(photo, index) in returnColumnItems(unsplashMedia, 2)">\n\t\t\t\t  <div v-if="!photo.error" \n\t\t\t\t  @click="selected = photo"\n\t\t\t\t  class="uip-flex uip-flex-column uip-flex-no-wrap uip-row-gap-xxs uip-cursor-pointer uip-position-relative">\n\t\t\t\t\t\n\t\t\t\t\t<img key="image" :src="photo.urls.small" \n\t\t\t\t\t:style="returnRatio(photo)"\n\t\t\t\t\tclass="uip-w-100p uip-max-w-100p uip-border-rounder" :alt="photo.alt_description"\n\t\t\t\t\t:class="{\'uip-brightness-05\' : photo.id == selected.id}">\n\t\t\t\t\t\n\t\t\t\t\t<div class="uip-position-absolute uip-padding-xs" v-if="photo.id == selected.id">\n\t\t\t\t\t  <div class="uip-border-circle uip-padding-xxxs uip-background-primary uip-active-outline uip-text-xs">\n\t\t\t\t\t   <span class="uip-icon uip-text-inverse">done</span>\n\t\t\t\t\t  </div> \n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<span class="uip-text-s uip-text-muted uip-max-w-100p uip-overflow-hidden uip-no-wrap uip-text-ellipsis">{{ photo.user.name }}</span>\n\t\t\t\t  </div>\n\t\t\t\t</template>\n\t\t\t  </div>\n\t\t\t  \n\t\t\t</div>\n\t\t  \n\t\t  </div>\n\t\t  \n\t\t  \n\t\t  \n\t\t  \n\t\t  \n\t\t  \n\t\t  \n\t\t  <div v-else-if="activeTab == \'library\'" class="uip-flex uip-flex-column uip-row-gap-s uip-flex-grow uip-max-h-100p uip-overflow-hidden">\n\t\t\t\n\t\t\t<div class="uip-background-muted uip-border-rounder uip-padding-xs uip-flex uip-flex-gap-s uip-flex-center">\n\t\t\t  <input class="uip-blank-input uip-flex-grow" type="text" v-model="search" @input="getMedia(true)" :placeholder="strings.search"> \n\t\t\t  <span class="uip-icon uip-text-muted uip-text-s">search</span>\n\t\t\t</div>\n\t\t\t\n\t\t\t<div v-if="media.length < 1 && search != \'\'" class="uip-text-muted">\n\t\t\t  {{strings.nothingFound}} <strong>{{search}}</strong>\n\t\t\t</div>\n\t\t\t\n\t\t\t<template v-for="(error, index) in media">\n\t\t\t  <div v-if="error.error" class="uip-border-rounder uip-padding-xs uip-padding-left-xs  uip-background-orange-wash uip-text-s">\n\t\t\t\t{{error.message}}\n\t\t\t  </div>\n\t\t\t</template>\n\t\t\t\n\t\t\t<div class="uip-grid-col-3 uip-grid-gap-s uip-overflow-auto uip-max-w-100p uip-flex-grow uip-max-h-100p" @scroll="onScrollMedia">\n\t\t\t  \n\t\t\t  \x3c!--Column 1--\x3e\n\t\t\t  <div class="uip-flex uip-flex-column uip-row-gap-s">\n\t\t\t\t<template v-for="(photo, index) in returnColumnItems(media, 0)">\n\t\t\t\t  <div v-if="!photo.error" \n\t\t\t\t  @click="selected = photo"\n\t\t\t\t  class="uip-flex uip-flex-column uip-flex-no-wrap uip-row-gap-xxs uip-cursor-pointer uip-position-relative">\n\t\t\t\t\t\n\t\t\t\t\t<img key="image" :src="returnImagePreview(photo)" \n\t\t\t\t\t:style="\'ratio:\' + photo.media_details.width / photo.media_details.height"\n\t\t\t\t\tclass="uip-w-100p uip-max-w-100p uip-border-rounder uip-translate-all" :alt="photo.alt_text"\n\t\t\t\t\t:class="{\'uip-brightness-05\' : photo.id == selected.id}">\n\t\t\t\t\t\n\t\t\t\t\t<div class="uip-position-absolute uip-padding-xs" v-if="photo.id == selected.id">\n\t\t\t\t\t  <div class="uip-border-circle uip-padding-xxxs uip-background-primary uip-active-outline uip-text-xs">\n\t\t\t\t\t   <span class="uip-icon uip-text-inverse">done</span>\n\t\t\t\t\t  </div> \n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<span class="uip-text-s uip-text-muted uip-max-w-100p uip-overflow-hidden uip-no-wrap uip-text-ellipsis">{{ photo.title.rendered }}</span>\n\t\t\t\t  </div>\n\t\t\t\t</template>\n\t\t\t  </div>\n\t\t\t  \n\t\t\t  \x3c!--Column 2--\x3e\n\t\t\t  <div class="uip-flex uip-flex-column uip-row-gap-s">\n\t\t\t\t<template v-for="(photo, index) in returnColumnItems(media, 1)">\n\t\t\t\t  <div v-if="!photo.error" \n\t\t\t\t  @click="selected = photo"\n\t\t\t\t  class="uip-flex uip-flex-column uip-flex-no-wrap uip-row-gap-xxs uip-cursor-pointer uip-position-relative">\n\t\t\t\t\t\n\t\t\t\t\t<img key="image" :src="returnImagePreview(photo)" \n\t\t\t\t\t:style="\'ratio:\' + photo.media_details.width / photo.media_details.height"\n\t\t\t\t\tclass="uip-w-100p uip-max-w-100p uip-border-rounder uip-translate-all" :alt="photo.alt_text"\n\t\t\t\t\t:class="{\'uip-brightness-05\' : photo.id == selected.id}">\n\t\t\t\t\t\n\t\t\t\t\t<div class="uip-position-absolute uip-padding-xs" v-if="photo.id == selected.id">\n\t\t\t\t\t  <div class="uip-border-circle uip-padding-xxxs uip-background-primary uip-active-outline uip-text-xs">\n\t\t\t\t\t   <span class="uip-icon uip-text-inverse uip-text-s">done</span>\n\t\t\t\t\t  </div> \n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<span class="uip-text-s uip-text-muted uip-max-w-100p uip-overflow-hidden uip-no-wrap uip-text-ellipsis">{{ photo.title.rendered }}</span>\n\t\t\t\t  </div>\n\t\t\t\t</template>\n\t\t\t  </div>\n\t\t\t  \n\t\t\t  \x3c!--Column 3--\x3e\n\t\t\t  <div class="uip-flex uip-flex-column uip-row-gap-s">\n\t\t\t\t<template v-for="(photo, index) in returnColumnItems(media, 2)">\n\t\t\t\t  <div v-if="!photo.error" \n\t\t\t\t  @click="selected = photo"\n\t\t\t\t  class="uip-flex uip-flex-column uip-flex-no-wrap uip-row-gap-xxs uip-cursor-pointer uip-position-relative">\n\t\t\t\t\t\n\t\t\t\t\t<img key="image" :src="returnImagePreview(photo)" \n\t\t\t\t\t:style="\'ratio:\' + photo.media_details.width / photo.media_details.height"\n\t\t\t\t\tclass="uip-w-100p uip-max-w-100p uip-border-rounder uip-translate-all" :alt="photo.alt_text"\n\t\t\t\t\t:class="{\'uip-brightness-05\' : photo.id == selected.id}">\n\t\t\t\t\t\n\t\t\t\t\t<div class="uip-position-absolute uip-padding-xs" v-if="photo.id == selected.id">\n\t\t\t\t\t  <div class="uip-border-circle uip-padding-xxxs uip-background-primary uip-active-outline uip-text-xs">\n\t\t\t\t\t   <span class="uip-icon uip-text-inverse">done</span>\n\t\t\t\t\t  </div> \n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<span class="uip-text-s uip-text-muted uip-max-w-100p uip-overflow-hidden uip-no-wrap uip-text-ellipsis">{{ photo.title.rendered }}</span>\n\t\t\t\t  </div>\n\t\t\t\t</template>\n\t\t\t  </div>\n\t\t\t  \n\t\t\t</div>\n\t\t  \n\t\t  </div>\n\t\t  \n\t\t  <div v-if="selected" class="uip-border-box uip-flex uip-gap-m uip-padding-top-xs uip-scale-in-bottom">\n\t\t\t\n\t\t\t\x3c!--WordPress--\x3e\n\t\t\t<div v-if="!selected.color" class="uip-max-w-50p uip-flex uip-flex-middle">\n\t\t\t  <img key="image" :src="returnImagePreview(selected)" \n\t\t\t  :style="\'ratio:\' + selected.media_details.width / selected.media_details.height"\n\t\t\t  class="uip-max-w-100p uip-border-rounder uip-max-h-200" :alt="selected.alt_text">\n\t\t\t</div>\n\t\t\t\n\t\t\t<div v-if="!selected.color" class="uip-flex uip-flex-column uip-row-gap-xs uip-flex-grow uip-flex-middle">\n\t\t\t  <form @change="updateMedia" class="uip-flex uip-flex-column uip-row-gap-xs uip-flex-grow uip-flex-middle">\n\t\t\t\t\n\t\t\t\t<div class="uip-grid-col-1-3">\n\t\t\t\t  <div class="uip-text-muted uip-flex uip-flex-center"><span>{{strings.title}}</span></div>\n\t\t\t\t  <input class="uip-input uip-flex-grow" type="text" v-model="selected.title.rendered" :placeholder="strings.imageTitle">\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div class="uip-grid-col-1-3">\n\t\t\t\t  <div class="uip-text-muted uip-flex uip-flex-center"><span>{{strings.altText}}</span></div>\n\t\t\t\t  <input class="uip-input uip-flex-grow" type="text" v-model="selected.alt_text" :placeholder="strings.aNicePhoto">\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div class="uip-grid-col-1-3">\n\t\t\t\t  <div class="uip-text-muted uip-flex uip-flex-center"><span>{{strings.caption}}</span></div>\n\t\t\t\t  <textarea class="uip-input uip-min-h-100" v-model="selected.caption.rendered" v-html="selected.caption.rendered"\n\t\t\t\t  :placeholder="strings.aNicePhotoDescription"></textarea>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t\n\t\t\t  </form>\n\t\t\t\n\t\t\t\n\t\t\t  <div class="uip-grid-col-1-3">\n\t\t\t\t<div class="uip-text-muted uip-flex uip-flex-center"><span>{{strings.size}}</span></div>\n\t\t\t\t<select class="uip-input" v-model="returnSize">\n\t\t\t\t  <template v-for="(size, key) in selected.media_details.sizes">\n\t\t\t\t\t<option :value="key">{{ key }}</option>\n\t\t\t\t  </template>\n\t\t\t\t</select>\n\t\t\t  </div>\n\t\t\t\n\t\t\t</div>\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t\x3c!--Unsplash--\x3e\n\t\t\t<div v-if="selected.color" class="uip-max-w-50p uip-flex uip-flex-middle">\n\t\t\t  <img key="image" :src="selected.urls.small" \n\t\t\t  :style="\'ratio:\' + selected.width / selected.height"\n\t\t\t  class="uip-max-w-100p uip-border-rounder uip-max-h-200" :alt="selected.alt_description">\n\t\t\t</div>\n\t\t\t\n\t\t\t<div v-if="selected.color" class="uip-flex uip-flex-column uip-row-gap-xs uip-flex-grow uip-flex-middle">\n\t\t\t  \n\t\t\t\t<span>\n\t\t\t\t  {{strings.photoBy}} \n\t\t\t\t  <a class="uip-link-primary" :href="selected.user.links.html + \'?utm_source=uipress&utm_medium=referral\'" target="_BLANK">{{selected.user.username}}</a>\n\t\t\t\t</span>\n\t\t\t\t\n\t\t\t\t<span>\n\t\t\t\t  {{strings.on}} \n\t\t\t\t  <a class="uip-link-primary" href="https://unsplash.com/?utm_source=uipress&utm_medium=referral" target="_BLANK">Unsplash</a>\n\t\t\t\t</span>\n\t\t\t  \n\t\t\t</div>\n\t\t  \n\t\t  </div>\n\t\t  \n\t\t  \n\t\t  <div class="uip-flex uip-gap-s uip-flex-between">\n\t\t  \n\t\t\t  <button class="uip-button-default uip-flex uip-gap-xs uip-flex-center" @click="$emit(\'cancel-select\')">\n\t\t\t\t<span>{{ strings.cancel }}</span>\n\t\t\t\t<div class="uip-background-grey uip-padding-left-xxs uip-padding-right-xxs uip-border-rounder uip-flex uip-flex-middle">\n\t\t\t\t  <span class="uip-text-muted uip-text-s">esc</span>\n\t\t\t\t</div>\n\t\t\t  </button>\n\t\t\t  \n\t\t\t  <button class="uip-button-primary uip-flex uip-gap-s uip-flex-center" @click="confirm" :disabled="ifDisabled">\n\t\t\t\t<span>{{ strings.select }}</span>\n\t\t\t  </button>\n\t\t  </div>\n      \n    </div>  \n\t\t'};export default{components:{Modal:defineAsyncComponent(()=>import("./modal.js")),MediaLibrary:MediaLibrary},data:()=>({resolvePromise:void 0,rejectPromise:void 0,strings:{mediaLibrary:__("Media library","uipress-lite")}}),methods:{cancel(){this.$emit("cancel-select"),this.$refs.popup.close(),this.resolvePromise(!1)},show(t={}){return this.selected=!1,this.$refs.popup.open(),this.resolvePromise=void 0,this.rejectPromise=void 0,requestAnimationFrame(()=>{this.$refs.confirmBody.focus()}),new Promise((t,e)=>{this.resolvePromise=t,this.rejectPromise=e})}},template:'\n  \n    <component is="style">\n      .imageload-enter-active,\n      .imageload-leave-active {\n      transition: all 0.5s ease;\n      }\n      .imageload-enter-from,\n      .imageload-leave-to {\n      opacity: 0;\n      }\n    </component>\n  \n    <Modal ref="popup">\n  \n      <div ref="confirmBody" @keydown.escape="cancel()" @click.stop\n      class="uip-w-500 uip-flex uip-flex-column uip-row-gap-s uip-padding-m" tabindex="1" \n      style="height:70vh;max-height:80vh" autofocus>\n      \n        <div class="uip-flex uip-gap-xs uip-flex-start uip-flex-no-wrap uip-max-h-100p">\n        \n          <h2 class="uip-margin-remove uip-flex-grow">{{ strings.mediaLibrary }}</h2>\n          <div @click="cancel()" class="uip-padding-xxs uip-border-rounder hover:uip-background-muted uip-cursor-pointer">\n            <span class="uip-icon uip-link-muted">close</span>\n          </div>\n        \n        </div>\n        \n        <MediaLibrary @image-selected="(d) => {resolvePromise(d);$refs.popup.close();}" \n        @cancel-select="$refs.popup.close();resolvePromise(false);"/>\n        \n      </div>\n    \n    </Modal>  \n  \n  \n  '};