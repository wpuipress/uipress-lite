export function ensureNestedObject(e,...a){a.reduce((e,a,t,r)=>(e[a]||(e[a]={}),e[a]),e)};export function hasNestedPath(e,...a){Array.isArray(a[0])&&(a=a[0]);for(let t of a){if(!e.hasOwnProperty(t))return!1;e=e[t]}return e};export function prepareJSON(e){return JSON.stringify(e,(e,a)=>"true"===a||!0===a?"uiptrue":"false"===a||!1===a?"uipfalse":""===a?"uipblank":a)};export function deepClone(e){const a=JSON.stringify(e);return JSON.parse(a)};export async function copyToClipboard(e){if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(e);else{const a=document.createElement("textarea");a.value=e,a.style.position="absolute",a.style.left="-999999px",document.body.prepend(a),a.select();try{document.execCommand("copy")}catch(e){console.error(e)}finally{a.remove()}}};export function isObject(e){return null!==e&&"object"==typeof e&&e.constructor===Object};export function isUnDefined(e){return void 0===e||(null===e||""===e)};export function get_block_option(e,a,t){if(isUnDefined(e.settings))return!1;if(!(a in e.settings))return!1;if(!isObject(e.settings[a]))return!1;if(!("options"in e.settings[a]))return!1;const r=e.settings[a].options;if(!isObject(r[t]))return!1;if(!("value"in r[t]))return!1;let n=r[t].value;return!isUnDefined(n)&&n};export function createUID(){let e=Date.now().toString(16)+Math.random().toString(16).slice(2);return e+=Math.random().toString(16).slice(2)+performance.now().toString(16),(generateRandomString(3)+e).substring(0,24)};export function generateRandomString(e=4){let a="";for(let t=0;t<e;t++){a+="abcdefghijklmnopqrstuvwxyz"[Math.floor(Math.random()*"abcdefghijklmnopqrstuvwxyz".length)]}return a};export async function sendServerRequest(e,a){const t=__("Bad request","uipress-lite"),r=await fetch(e,{method:"POST",headers:{"Content-Length":"0"},body:a});if(!r.ok)return t(t),{error:!0,message:t};const n=uipParseJson(await r.text());return n||(t(t),{error:!0,message:t})};export function uipParseJson(e){return JSON.parse(e,(e,a)=>"uiptrue"===a||"uipfalse"!==a&&("uipblank"===a?"":a))};export function updateAppPage(e,a){const t=new RegExp("^(?:[a-z+]+:)?//","i"),r=this.adminURL;let n=e=e.replace(/&amp;/g,"&");t.test(e)&&e.includes(r)&&(n=e.replace(r,""));const i=stripUIPparams(n,r),s=new CustomEvent("uipress/app/page/change",{detail:{url:i}});document.dispatchEvent(s),t.test(e)||(e=r+e);let o=new URL(e);const c=this.isBuilder;if("undefined"!=typeof UIPdisableUserPages&&(e=>{if(Array.isArray(e)&&!c)for(let a of e)(o.href==a||o.href.includes(a))&&window.location.assign(o)})(UIPdisableUserPages),"undefined"!=typeof UIPdisableDynamicLoading){if(!isUnDefined(UIPdisableDynamicLoading)&&!c)return window.location.assign(o)}if("undefined"!=typeof UIPfrontEndReload){if(!isUnDefined(UIPfrontEndReload)&&!c&&!o.href.includes(r))return window.location.assign(o)}if(maybeForceReload(o),a&&!c)return o.searchParams.set("uip-framed-page",0),window.location.assign(o);const p=new CustomEvent("uip_update_frame_url",{detail:{url:o}});document.dispatchEvent(p),document.querySelector(".uip-page-content-frame")||c||window.location.assign(o)};export function updateActiveLink(e){const a=this.adminURL;let t=new RegExp("^(?:[a-z+]+:)?//","i"),r=t.test(e)&&e.includes(a)?e.replace(a,""):e,n=t.test(e)?e:a+e;n=n.replace("about:blank",""),r=r.replace("about:blank","");let i=new URL(n);i.searchParams.delete("uip-framed-page",1),i.searchParams.delete("uip-hide-screen-options",1),i.searchParams.delete("uip-hide-help-tab",1),i.searchParams.delete("uip-default-theme",1),i.searchParams.delete("uip-hide-notices",1),i.searchParams.delete("uipid",1),maybeForceReload(i);const s=new CustomEvent("uipress/app/page/change",{detail:{url:stripUIPparams(r,a)}});document.dispatchEvent(s)};export function stripUIPparams(e,a){let t=new RegExp("^(?:[a-z+]+:)?//","i").test(e)?new URL(e):new URL(a+e);return t.searchParams.delete("uip-framed-page",1),t.searchParams.delete("uip-hide-screen-options",1),t.searchParams.delete("uip-hide-help-tab",1),t.searchParams.delete("uip-default-theme",1),t.searchParams.delete("uip-hide-notices",1),t.searchParams.delete("uipid"),t.href.replace(a,"")};export function maybeForceReload(e){return"run"==e.searchParams.get("bricks")?window.location.assign(e):"motionpage"==e.searchParams.get("page")?(e.searchParams.set("uip-framed-page",1),window.location.assign(e)):"elementor"==e.searchParams.get("action")?(e.searchParams.set("uip-framed-page",1),window.location.assign(e)):"elementor-app"==e.searchParams.get("page")?(e.searchParams.set("uip-framed-page",1),window.location.assign(e)):"builder"==e.searchParams.get("breakdance")?(e.searchParams.set("uip-framed-page",1),window.location.assign(e)):"true"==e.searchParams.get("ct_builder")?(e.searchParams.set("uip-framed-page",1),window.location.assign(e)):"piotnetforms"==e.searchParams.get("page")&&e.searchParams.get("post")?(e.searchParams.set("uip-framed-page",1),window.location.assign(e)):"zion_builder_active"==e.searchParams.get("action")?(e.searchParams.set("uip-framed-page",1),window.location.assign(e)):"1"==e.searchParams.get("et_fb")?(e.searchParams.set("uip-framed-page",1),window.location.assign(e)):void 0};export async function saveUserPreference(e,a,t){console.log(e);let r=new FormData;return a=prepareJSON(a=0==(a=1==a?"uiptrue":a)?"uipfalse":a),r.append("action","uip_save_user_preference"),r.append("security",uip_ajax.security),r.append("key",e),r.append("value",a),!(await sendServerRequest(uip_ajax.ajax_url,r)).error};export async function validDateTemplate(e,a){return Promise.all(e.map(e=>validateBlock(e,a)))};async function validateBlock(e,a){return!(!e.name||!e.moduleName)&&(a||(e.uid=createUID()),!e.content||(await Promise.all(e.content.map(e=>validateBlock(e,a)))).every(e=>e))}export function renderKeyShortCut(e){const a=["Enter"," ","ArrowLeft","ArrowUp","ArrowRight","ArrowDown"],t=[{key:"Enter",icon:"keyboard_return"},{key:" ",icon:"space_bar"},{key:"ArrowLeft",icon:"keyboard_arrow_left"},{key:"ArrowUp",icon:"keyboard_arrow_up"},{key:"ArrowRight",icon:"keyboard_arrow_right"},{key:"ArrowDown",icon:"keyboard_arrow_down"}];let r="";for(let n of e)if("Meta"==n)r+='<span class="uip-command-icon uip-text-muted"></span>';else if("Alt"==n)r+='<span class="uip-alt-icon uip-text-muted"></span>';else if("Shift"==n)r+='<span class="uip-shift-icon uip-text-muted"></span>';else if("Control"==n)r+='<span class="uip-icon uip-text-muted">keyboard_control_key</span>';else if("Backspace"==n)r+='<span class="uip-icon uip-text-muted">backspace</span>';else if(a.includes(n)){r+=`<span class="uip-icon uip-text-muted">${t.find(e=>e.key==n).icon}</span>`}else r+=`<span class="uip-text-muted uip-text-uppercase" style="line-height: 16px;font-size: 11px;">${n}</span>`;return r};export async function deleteRemotePost(e){if(!e)return;let a=Array.isArray(e)?JSON.stringify(e):JSON.stringify([e]),t=new FormData;t.append("action","uip_delete_post"),t.append("security",uip_ajax.security),t.append("id",a);const r=await sendServerRequest(uip_ajax.ajax_url,t);return!r.error&&(!!r.success||void 0)};export async function getUserPreference(e){let a=new FormData;a.append("action","uip_get_user_preference"),a.append("security",uip_ajax.security),a.append("key",e);const t=await sendServerRequest(uip_ajax.ajax_url,a);return!t.error&&t.value};