const{__:__,_x:_x,_n:_n,_nx:_nx}=wp.i18n;import{defineAsyncComponent}from"../../../libs/vue-esm.js";export default{components:{colorSelect:defineAsyncComponent(()=>import("../libs/colorpicker.js")),contextmenu:defineAsyncComponent(()=>import("../utility/contextmenu.min.js?ver=3.3.1"))},props:{currentColor:String,returnData:Function,actualValue:String},data:()=>({contextIndex:!1,scrollBottom:!1,showSearch:!1,search:"",strings:{styles:__("Styles","uipress-lite"),create:__("Create","uipress-lite"),delete:__("Delete","uipress-lite"),duplicate:__("Duplicate","uipress-lite"),edit:__("Edit","uipress-lite"),createShades:__("Create shades","uipress-lite"),copyVariable:__("Copy variable","uipress-lite"),searchStyles:__("Search styles","uipress-lite")}}),watch:{"uipApp.data.themeStyles":{handler(){this.saveStyles()},deep:!0}},computed:{returnActiveMode(){return this.uipApp.data.userPrefs.darkTheme?this.uipApp.data.userPrefs.darkTheme?"darkValue":void 0:"value"},activeStyle(){if(this.actualValue&&this.actualValue.includes("--"))return this.actualValue},returnUserStyles(){this.uipApp.data.themeStyles||(this.uipApp.data.themeStyles={});let t=this.search.toLowerCase();return Object.entries(this.uipApp.data.themeStyles).filter(([e,n])=>(n.name=e,("color"===n.type||!("name"in n))&&this.maybeToLowerCase(n.name).includes(t))).map(([t,e])=>(e.type="color",e))},canDeleteVar(){return!1===this.contextIndex||!!this.uipApp.data.themeStyles[this.contextIndex]&&!this.uipApp.data.themeStyles[this.contextIndex].user}},methods:{maybeToLowerCase:t=>t?t.toLowerCase():"",async saveStyles(){let t=JSON.stringify(this.uipApp.data.themeStyles),e=new FormData;e.append("action","uip_save_user_styles"),e.append("security",uip_ajax.security),e.append("styles",t);const n=await this.sendServerRequest(uip_ajax.ajax_url,e);return n.error&&this.uipApp.notifications.notify(n.message,"uipress-lite","","error",!0),!0},addNewStyle(){const t={name:"",type:"color",value:this.currentColor,darkValue:this.currentColor,user:!0};let e={component:"colourStyleEditor",label:__("New color style","uipress-lite"),value:t,returnData:t=>{this.uipApp.data.themeStyles[t.name]=t,this.$emit("go-back")}};this.$emit("request-screen",e)},editColor(){const t=this.uipApp.data.themeStyles[this.contextIndex];let e={component:"colourStyleEditor",label:__("Edit color style","uipress-lite"),value:t,returnData:!1};this.$refs.colorcontext.close(),this.$emit("request-screen",e)},duplicateColor(){const t=this.uipApp.data.themeStyles[this.contextIndex];let e=JSON.parse(JSON.stringify(t));e.name+="-copy";let n={component:"colourStyleEditor",label:__("New color style","uipress-lite"),value:e,returnData:t=>{this.seqlData.options.app_data.styles.push(t),this.$emit("go-back")}};this.$refs.colorcontext.close(),this.$emit("request-screen",n)},setColor(t){this.returnData(t)},checkForBottomScroll(t){const e=t.target;e.scrollTop+e.clientHeight>=e.scrollHeight-16?this.scrollBottom=!0:this.scrollBottom=!1},maybeHideSearch(){0!==this.search.length&&this.search||(this.showSearch=!1)},returnStyleBackground(t){const e=this.returnActiveMode;return t[e]?t[e].includes("--")?`var(${t[e]})`:t[e]:`var(${t.name})`}},template:'\n  \n\t<div class="uip-flex uip-flex-column uip-row-gap-xs uip-position-relative">\n\t  \n\t  <div class="uip-flex uip-flex-between uip-flex-center">\n\t  \n\t\t<component is="style" scoped>\n\t\t  .searchfade-enter-active,\n\t\t  .searchfade-leave-active {\n\t\t\ttransition: all 0.2s ease;\n\t\t  }\n\t\t  .searchfade-enter-from,\n\t\t  .searchfade-leave-to {\n\t\t\topacity: 0;\n\t\t\ttransform: translateX(30px);\n\t\t  }\n\t\t</component>\n\t  \n\t\t<Transition name="searchfade" mode="out-in">\n\t\t\n\t\t  <div key="title" v-if="!showSearch" class="uip-text-bold uip-text-emphasis" @mouseenter="showSearch = true;">{{ strings.styles }}</div>\n\t\t  \n\t\t  \x3c!-- Search --\x3e\n\t\t  <div key="search" v-else @mouseleave="maybeHideSearch" class="uip-flex uip-gap-xs uip-flex-center">\n\t\t\t<span class="uip-icon">search</span>\n\t\t\t<input class="uip-input uip-blank-input uip-text-s" type="text" @blur="maybeHideSearch" v-model="search" :placeholder="strings.searchStyles" autofocus>\n\t\t  </div>\n\t\t\n\t\t</Transition>\n\t\t\n\t\t<div @click="addNewStyle" \n\t\tclass="uip-flex uip-flex-center uip-flex-middle uip-padding-xxs uip-link-default hover:uip-background-muted uip-border-rounder">\n\t\t  <span class="uip-icon">add</span>\n\t\t</div>\n\t  </div>\n\t  \n\t  \n\t  <div class="uip-flex uip-flex-column uip-max-h-160" @scroll="checkForBottomScroll" style="overflow:auto">\n\t\t\n\t\t\n\t  \n\t\t<template v-for="(style, index) in returnUserStyles">\n\t\t\n\t\t  <div @contextmenu.prevent.stop="contextIndex = style.name; $refs.colorcontext.show($event)" \n\t\t  @click="setColor(style)"\n\t\t  :class="{\'uip-background-muted\' : activeStyle == style.name, \'hover:uip-background-muted\' : activeStyle != style.name}"\n\t\t  class="uip-flex uip-gap-s uip-flex-center uip-padding-xxs uip-padding-left-xs uip-link-default uip-border-rounder">\n\t\t  \n\t\t\t<div class="uip-w-16 uip-border-circle uip-ratio-1-1 uip-background-checkered">\n\t\t\t  <div class="uip-w-16 uip-border-circle uip-ratio-1-1 uip-border" :style="{background:returnStyleBackground(style)}">\n\t\t\t  \n\t\t\t  </div>\n\t\t\t</div>\n\t\t\t\n\t\t\t<div class="">{{style.name}}</div>\n\t\t\t\n\t\t  </div>\n\t\t\n\t\t</template>\n\t\t\n\t\t\n\t\t\n\t\t\n\t  </div>\n\t  \n\t  <div class="uip-fade-in uip-position-absolute uip-bottom-0 uip-w-100p" v-if="!scrollBottom && search == \'\'" style="pointer-events: none">\n\t\t<div style="position:absolute;top:0px;background-image: linear-gradient(to top, var(--uip-color-base-0) , transparent);transform:translateY(-100%);height: 60px;width:100%;z-index:9"></div>\n\t  </div>\n\t  \n\t  \n\t  <contextmenu ref="colorcontext" :disableTeleport="true">\n\t\t  \n\t\t  <div class="uip-padding-xs uip-flex uip-flex-column uip-text-weight-normal uip-text-s">\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t<a class="uip-link-default uip-flex uip-gap-m uip-flex-between uip-flex-center hover:uip-background-muted uip-border-round uip-padding-xxs"\n\t\t\t@click.prevent="editColor">\n\t\t\t  <span class="">{{strings.edit}}</span>\n\t\t\t  <span class="uip-icon">edit</span>\n\t\t\t</a>\n\t\t\t\n\t\t\t<a class="uip-link-default uip-flex uip-gap-m uip-flex-between uip-flex-center hover:uip-background-muted uip-border-round uip-padding-xxs"\n\t\t\t@click.prevent="duplicateColor">\n\t\t\t  <span class="">{{strings.duplicate}}</span>\n\t\t\t  <span class="uip-icon">content_copy</span>\n\t\t\t</a>\n\t\t\t\n\t\t\t<div class="uip-border-top uip-margin-top-xs uip-margin-bottom-xs "></div>\n\t\t  \n\t\t\t<a class="uip-link-danger uip-flex uip-gap-m uip-flex-between uip-flex-center hover:uip-background-muted uip-border-round uip-padding-xxs"\n\t\t\t@click.prevent="delete this.uipApp.data.themeStyles[contextIndex];$refs.colorcontext.close()" :class="{\'uip-link-disabled\' : canDeleteVar}">\n\t\t\t  <span class="">{{strings.delete}}</span>\n\t\t\t  <span class="uip-icon">delete</span>\n\t\t\t</a>\n\t\t  \n\t\t  </div>\n\t  \n\t  </contextmenu>\n   \n   \n\t</div>\n\t\t'};