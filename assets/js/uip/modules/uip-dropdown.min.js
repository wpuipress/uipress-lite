import{nextTick}from"../../libs/vue-esm-dev.js";export default{props:{pos:{type:String,default:"bottom left"},onOpen:Function,offsetX:{type:Number,default:8},offsetY:{type:Number,default:8},shortCut:[Boolean,String,Array]},data:()=>({modelOpen:!1,currentHeight:0,position:{left:"auto",right:"auto",top:"auto",bottom:"auto",opacity:0}}),beforeUnmount(){document.removeEventListener("scroll",this.handleScroll,!0)},mounted(){this.mountShortcut()},methods:{mountShortcut(){if(!this.shortCut)return;const t=[...this.shortCut];let o=new Set;window.addEventListener("keydown",i=>{o.add(i.key),t.every(t=>o.has(t))&&this.show()}),window.addEventListener("keyup",()=>{o.clear()})},resetPosition(){this.position={left:"auto",right:"auto",top:"auto",bottom:"auto",opacity:0}},handleScroll(){this.setPosition()},onClickOutside(t){this.$refs.droptrigger.contains(t.target)||this.$refs.uipdrop.contains(t.target)||this.close()},show(){if(this.modelOpen)return this.close();this.modelOpen=!0,document.addEventListener("scroll",this.handleScroll,!0),document.body.addEventListener("click",this.onClickOutside,!0),this.onOpen&&this.onOpen(),setTimeout(()=>{this.setPosition()},100)},close(){this.modelOpen=!1,this.position.opacity=0,document.body.removeEventListener("click",this.onClickOutside,!0),document.removeEventListener("scroll",this.handleScroll,!0)},setPosition(){const t=this.$refs.uipdrop,o=this.$refs.droptrigger;if(!t||!o)return;this.resetPosition();const i=o.getBoundingClientRect(),e=window.innerHeight||document.documentElement.clientHeight,n=window.innerWidth||document.documentElement.clientWidth;let s=this.pos.split(" "),r=s[0],p=s[1];"bottom"==r&&(this.position.top=`${i.bottom+this.offsetY}px`),"top"==r&&(this.position.bottom=`${e-i.top+this.offsetY}px`),"left"==r&&(this.position.right=`${n-i.left+this.offsetX}px`),"right"==r&&(this.position.left=`${i.right+this.offsetX}px`),"left"==p&&(this.position.left=`${i.left}px`),"right"==p&&(this.position.right=`${n-i.right}px`),"top"==p&&(this.position.top=`${i.top}px`),"bottom"==p&&(this.position.bottom=`${e-i.bottom}px`),"center"!=p||"left"!=r&&"right"!=r||(this.position.top=`${i.top-t.offsetHeight/2}px`),"center"!=p||"top"!=r&&"bottom"!=r||(this.position.left=`${i.left-(t.offsetWidth-o.offsetWidth)/2}px`),nextTick(()=>{let o=t.getBoundingClientRect();o.top<0&&(this.position.top=`${i.top}px`),o.bottom>e&&(this.position.top=`${o.top-(o.bottom-e)-16}px`),o.left<0&&(this.position.left="0px"),o.right>n&&(this.position.left=`${n-t.offsetWidth}px`),this.position.opacity=1})}},template:'\n      <div ref="droptrigger"\n      @click="show($event)">\n      \n        <slot name="trigger"/>\n        \n        <teleport to="body">\n          <div v-if="modelOpen && $slots.content"\n          ref="uipdrop" class="uip-z-index-9 uip-position-fixed uip-shadow uip-background-default uip-border-rounder uip-body-font" \n          style="border-radius:calc(var(--uip-border-radius-large) + var(--uip-padding-xxs));" :style="position">\n        \n          <slot name="content"/>\n            \n          </div>\n        </teleport>\n        \n      </div>'};