import*as charts from"../../libs/charts.min.js";export function moduleData(){return{props:{chartData:Object},data:function(){return{chart:!1,loading:!1,acceptedData:!1,rendered:!0}},inject:["uipress"],watch:{chartData:{handler(t,e){if(JSON.stringify(t)==JSON.stringify(this.acceptedData))return;let a=this;a.chart.destroy(),a.chart=!1,a.acceptedData=JSON.parse(JSON.stringify(a.chartData)),a.rendered=!1,requestAnimationFrame(function(){a.rendered=!0,a.createChart()})},deep:!0}},computed:{},mounted:function(){this.acceptedData=JSON.parse(JSON.stringify(this.chartData)),this.createChart()},methods:{createChart(){let t=this;if(t.chart)return;let e=getComputedStyle(document.documentElement),a=e.getPropertyValue("--uip-color-accent"),o=e.getPropertyValue("--uip-color-red-lighter");""!=t.acceptedData.colors.main&&(a=t.acceptedData.colors.main),""!=t.acceptedData.colors.comp&&(o=t.acceptedData.colors.comp);let i=t.formatLabels(this.acceptedData.labels),r="",d=!1,s="",c=!1;t.uipress.isObject(t.acceptedData.custom)&&((r=t.acceptedData.custom.dataBackground)&&(d=!0),(s=t.acceptedData.custom.compBackground)&&(c=!0));let n={labels:i,datasets:[{label:t.acceptedData.title,backgroundColor:r,fill:d,borderColor:a,data:t.acceptedData.data.main}]};t.acceptedData.data.comparison.length>0&&n.datasets.push({label:t.acceptedData.title,backgroundColor:s,fill:c,borderColor:o,data:t.acceptedData.data.comparison});const l={type:t.acceptedData.type,data:n,options:t.buildTheChartOptions()};t.chart=new Chart(t.$refs.uipChart,l)},formatLabels(t){let e=[];for(let[a,o]of t.main.entries()){let i=o;t.comparison&&t.comparison[a]&&(i=o+";"+t.comparison[a]),e.push(i)}return e},buildTheChartOptions(){let t=this,e=.15,a=!1,o=!1,i=!0,r=!1,d=3;return t.uipress.isObject(t.acceptedData.custom)&&(e=t.acceptedData.custom.tension,a=t.acceptedData.custom.showXaxis,o=t.acceptedData.custom.showYaxis,i=t.acceptedData.custom.showYaxisGrid,r=t.acceptedData.custom.showXaxisGrid,d=t.acceptedData.custom.borderWidth),{cutout:"0%",spacing:0,borderRadius:0,tension:e,pointRadius:0,pointHoverRadius:5,borderRadius:8,animation:!0,borderWidth:d,interaction:{mode:"nearest"},hover:{intersect:!1},borderSkipped:!1,plugins:{legend:{display:!1,position:"bottom"},tooltip:{position:"average",backgroundColor:"#fff",padding:20,bodySpacing:10,bodyFont:{size:12},titleFont:{size:14,weight:"bold"},mode:"index",intersect:!1,xAlign:"left",yAlign:"center",caretPadding:10,cornerRadius:4,borderColor:"rgba(162, 162, 162, 0.2)",borderWidth:1,titleColor:"#333",bodyColor:"#777",titleMarginBottom:10,bodyFontSize:100,usePointStyle:!0,enabled:!1,external:function(e){t.getTooltip(e)}}},scales:{x:{ticks:{display:a},grid:{borderWidth:0,display:i,borderDash:[10,8],color:"rgba(162, 162, 162, 0.4)"}},y:{beginAtZero:!0,ticks:{display:o},grid:{borderWidth:0,display:r}}}}},getTooltip(t){let e=document.getElementById("chartjs-tooltip");e||((e=document.createElement("div")).id="chartjs-tooltip",e.innerHTML="<div class='uip-background-default uip-boder uip-shadow uip-border-rounder uip-overflow-hidden'></div>",document.body.appendChild(e));let a=t.tooltip;if(0!==a.opacity){if(e.classList.remove("above","below","no-transform"),a.yAlign?e.classList.add(a.yAlign):e.classList.add("no-transform"),a.body){a.title,a.body.map(function(t){return t.lines});let o=a.dataPoints[0].dataset.label,i='<div class="uip-background-default">';i+="<div class='uip-text-bold uip-padding-xs uip-border-bottom uip-body-font'>"+o+"</div>",i+='<div class="uip-padding-xs uip-flex uip-flex-column uip-row-gap-xxs">',a.dataPoints.forEach(function(t,e){let o=t.label.split(";")[e],r=a.labelColors[e].borderColor;i+='<div class="uip-flex uip-flex-row uip-gap-xxs uip-flex-between uip-w-125">',i+='<div class="uip-text-bold" style="color:'+r+'">'+t.formattedValue+"</div>",i+='<div class="uip-text-s uip-text-muted uip-no-wrap">'+o+"</div>",i+="</div>"}),i+="</div>",i+="</div>",e.querySelector("div").innerHTML=i;let r=t.chart.canvas.getBoundingClientRect();Chart.helpers.toFont(a.options.bodyFont);e.style.opacity=1,e.style.position="absolute",e.style.left=r.left+window.pageXOffset+a.caretX+"px",e.style.top=r.top+window.pageYOffset+a.caretY+"px",e.style.padding=a.padding+"px "+a.padding+"px",e.style.pointerEvents="none"}}else e.style.opacity=0}},template:'\n       <canvas v-if="rendered" class="uip-min-w-100 uip-chart-canvas" ref="uipChart"></canvas>'}};