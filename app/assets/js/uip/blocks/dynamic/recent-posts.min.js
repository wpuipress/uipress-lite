const{__:__,_x:_x,_n:_n,_nx:_nx}=wp.i18n;export default{props:{display:String,name:String,block:Object},data:()=>({searchString:"",results:[],page:1,totalPages:0,loading:!1,strings:{nothingFound:__("Nothing posts found","uipress-lite"),by:__("By","uipress-lite")},searching:!1}),mounted(){this.getPosts()},watch:{page:{handler(t,i){t&&this.getPosts()}},"block.settings.block.options":{handler(t,i){this.getPosts()},deep:!0}},computed:{returnPerPage(){return this.block.settings.block.options.postsPerPage.value},postTypes(){return this.get_block_option(this.block,"block","activePostTypes")},perPage(){return this.get_block_option(this.block,"block","postsPerPage")},limitToAuthor(){let t=this.get_block_option(this.block,"block","limitToAuthor");return!!t&&(this.isObject(t)?!!t.value&&t.value:t)}},methods:{async getPosts(){if(this.loading)return;this.loading=!0;const t=this.postTypes;let i=new FormData;i.append("action","uip_get_recent_posts"),i.append("security",uip_ajax.security),i.append("search",this.searchString),i.append("page",this.page),i.append("postTypes",JSON.stringify(t)),i.append("perPage",this.returnPerPage),i.append("limitToAuthor",this.limitToAuthor);const e=await this.sendServerRequest(uip_ajax.ajax_url,i);if(!e)return this.uipApp.notifications.notify(__("Unable to fetch posts at this tiem","uipress-lite"),"","","error",!0),void(this.searching=!1);e.error&&(this.uipApp.notifications.notify(e.message,"","","error",!0),this.searching=!1),e.success&&(this.loading=!1,this.results=e.posts,this.totalPages=e.totalPages)},goBack(){this.page>1&&this.page--},goForward(){this.page<this.totalPages&&this.page++}},template:'\n    \n            <div class="uip-flex uip-flex-column uip-row-gap-s">\n              <div class="uip-flex uip-flex-column uip-row-gap-xs uip-list-area">\n                <loading-chart v-if="loading"></loading-chart>\n                <template  v-if="!loading" v-for="item in results">\n                  <div class="uip-flex uip-flex-row uip-flex-between uip-flex-center" @mouseover="item.hover = true" @mouseleave="item.hover = false">\n                    <div class="">\n                      <div class="uip-flex uip-flex-row uip-gap-xxs uip-flex-center" >\n                        <div class="uip-text-bold uip-post-title uip-link-default uip-cursor-pointer"  @click="updateAppPage(item.link)">{{item.name}}</div>\n                        <div class="uip-text-xs uip-background-primary-wash uip-border-round uip-padding-xxxs uip-post-type-label">{{item.type}}</div>\n                        <div class="uip-flex uip-gap-xxs uip-flex-center" v-if="item.hover">\n                          <div @click="updateAppPage(item.editLink)" :href="item.editLink" class="uip-icon uip-cursor-pointer uip-link-muted">edit_document</div>\n                          <a :href="item.link" target="_BLANK" class="uip-icon uip-cursor-pointer uip-link-muted uip-no-underline">open_in_new</a>\n                        </div>\n                      </div>\n                      <div class="uip-text-s uip-post-meta uip-flex uip-flex-row uip-gap-xxxs">\n                        <span class="uip-text-muted">{{strings.by}}</span>\n                        <span class="">{{item.author}}</span>\n                        <span class="uip-text-muted">{{item.modified}}</span>\n                      </div>\n                    </div>\n                  </div>\n                </template>\n                <div v-if="results.length == 0 && searchString.length > 0" class="uip-text-muted uip-text-s">\n                  {{strings.nothingFound}}\n                </div>\n              </div>\n              <div class="uip-flex uip-gap-xs" v-if="totalPages > 1">\n                <button @click="goBack" class="uip-button-default uip-icon uip-nav-button">chevron_left</button>\n                <button @click="goForward" v-if="page < totalPages" class="uip-button-default uip-icon uip-nav-button">chevron_right</button>\n              </div>\n            </div>\n            \n            '};