const{__:__,_x:_x,_n:_n,_nx:_nx}=wp.i18n;export default{props:{display:String,name:String,block:Object},data:()=>({searchString:"",results:[],types:[],activeType:"all",page:1,totalPages:0,totalFound:0,strings:{searchPlaceHolder:__("Search content","uipress-lite"),nothingFound:__("Nothing found for query","uipress-lite"),by:__("by","uipress-lite"),found:__("found","uipress-lite"),all:__("All","uipress-lite"),edit:__("Edit","uipress-lite"),view:__("View","uipress-lite"),copy:__("Copy url","uipress-lite")},searching:!1}),watch:{searchString:{handler(i,e){i?(this.page=1,this.searchContent()):this.results=[]}},page:{handler(i,e){i&&this.searchContent()}},activeType:{handler(i,e){i&&this.searchContent()}}},computed:{getPostTypes(){return this.get_block_option(this.block,"block","searchPostTypes")},limitToAuthor(){let i=this.get_block_option(this.block,"block","limitToAuthor");return!!i&&(this.isObject(i)?!!i.value&&i.value:i)}},methods:{async searchContent(){if(this.searching)return;this.searching=!0;let i=[];const e=this.limitToauthor;Array.isArray(this.getPostTypes)&&(i=this.getPostTypes),i=JSON.stringify(i);let t=new FormData;t.append("action","uip_search_content"),t.append("security",uip_ajax.security),t.append("search",this.searchString),t.append("page",this.page),t.append("limitToauthor",e),t.append("postTypes",i),t.append("filter",this.activeType);const n=await this.sendServerRequest(uip_ajax.ajax_url,t);if(!n)return this.uipApp.notifications.notify(__("Unable to fetch posts at this tiem","uipress-lite"),"","","error",!0),void(this.searching=!1);n.error&&(this.uipApp.notifications.notify(n.message,"","","error",!0),this.searching=!1),n.success&&(this.searching=!1,this.results=n.posts,this.totalPages=n.totalPages,this.totalFound=n.totalFound,this.types=n.types)},goBack(){this.page>1&&this.page--},goForward(){this.page<this.totalPages&&this.page++}},template:'\n            <div class="uip-flex uip-flex-column">\n            \n              <div class="uip-flex uip-padding-xxs uip-border uip-search-block uip-border-round uip-flex-center uip-margin-bottom-s uip-position-relative">\n                <span class="uip-icon uip-text-muted uip-margin-right-xs">search</span> \n                <input class="uip-blank-input uip-flex-grow uip-text-s" type="search" :placeholder="strings.searchPlaceHolder" v-model="searchString" autofocus>\n                \n                <div class="uip-position-absolute uip-left-0 uip-bottom-0 uip-w-100p" v-if="searching">\n                  <div ref="loader" class="uip-ajax-loader">\n                    <div class="uip-loader-bar"></div>\n                  </div>\n                </div>\n                \n              </div>\n              \n              \n              <template v-if="results.length > 0">\n                \n                \n              \n                <div class="uip-flex uip-flex-column uip-row-gap-xs uip-padding-xxs uip-search-results-area">\n                \n                  <div class="uip-flex uip-flex-row uip-gap-xs uip-border-bottom uip-margin-bottom-s uip-padding-left-xxs">\n                    \n                    <div class="uip-link-muted uip-padding-xxs" :class="{\'uip-border-bottom-primary uip-text-emphasis\' : activeType == \'all\'}" @click="activeType = \'all\'">{{strings.all}}</div>\n                    \n                    <template v-for="type in types">\n                        <div class="uip-link-muted uip-padding-xxs" :class="{\'uip-border-bottom-primary uip-text-emphasis\' : activeType == type.name}" @click="activeType = type.name">{{type.label}}</div>\n                    </template>\n                    \n                    <div class="uip-flex-grow uip-flex uip-flex-right uip-padding-xxs">\n                      <button class="uip-button-default uip-icon uip-border-rounder uip-padding-xxs uip-link-muted" @click="searchString = \'\'">close</button>\n                    </div>\n                  </div>\n                \n                  \n                  \n                  <div class="uip-flex uip-flex-column uip-row-gap-xs uip-found-items-list">\n                    <template v-for="item in results">\n                      <div class="uip-flex uip-flex-row uip-gap-s uip-flex-center" @mouseover="item.hover = true" @mouseleave="item.hover = false">\n                      \n                        <div v-if="item.icon == \'article\' || !item.icon" class="uip-border uip-border-round uip-padding-xxs">\n                          <div v-if="item.icon == \'article\'" class="uip-icon">article</div>\n                          <div v-if="!item.icon" class="uip-icon">collections</div>\n                        </div>\n                        \n                        <div v-else class="uip-border uip-border-round uip-w-25 uip-ratio-1-1 uip-background-cover"\n                        :style="\'background-image: url(\' + item.icon + \')\'">\n                        </div>\n                        \n                        <div class="">\n                          <div class="uip-flex uip-flex-row uip-gap-xxs uip-flex-center" >\n                          \n                            <div class="uip-text-bold uip-search-result-title uip-link-default uip-cursor-pointer"  @click="updateAppPage(item.link)" v-html="item.name"></div>\n                            \n                            <div class="uip-text-xs uip-background-primary-wash uip-border-round uip-padding-xxxs uip-hidden">{{item.type}}</div>\n                            \n                          </div>\n                          <div class="uip-text-s uip-search-result-meta uip-flex uip-flex-row uip-gap-xxxs">\n                            <span >{{item.type}}</span>\n                            <span class="uip-text-muted">{{strings.by}}</span>\n                            <span class="">{{item.author}}</span>\n                            <span class="uip-text-muted">{{item.modified}}</span>\n                          </div>\n                        </div>\n                        \n                        \x3c!--Options Dropdown--\x3e\n                        <div class="uip-flex-grow uip-flex uip-flex-right">\n                        \n                          <dropdown pos="bottom right">\n                          \n                            <template v-slot:trigger>\n                              <div class="uip-icon uip-link-muted uip-text-l">more_vert</div>\n                            </template>\n                            \n                            <template v-slot:content>\n                              <div class="uip-flex uip-flex-column uip-row-gap-xxs uip-padding-xxs">\n                              \n                                <a :href="item.editLink" class="uip-link-muted hover:uip-background-muted uip-border-round uip-padding-xxxs uip-flex uip-flex-row uip-gap-xs uip-flex-center uip-no-underline">\n                                  <div class="uip-icon uip-text-l">edit</div>\n                                  <div class="uip-no-wrap">{{strings.edit + \' \' + item.type}}</div>\n                                </a>\n                                \n                                <a :href="item.link" class="uip-link-muted hover:uip-background-muted uip-border-round uip-padding-xxxs uip-flex uip-flex-row uip-gap-xs uip-flex-center uip-no-underline" @click="updateAppPage(item.link)">\n                                  <div class="uip-icon uip-text-l">visibility</div>\n                                  <div class="uip-no-wrap">{{strings.view + \' \' + item.type}}</div>\n                                </a>\n                                \n                                \n                              </div>\n                            </template>\n                            \n                          </dropdown>\n                        </div>\n                        \x3c!--End--\x3e\n                      </div>\n                    </template>\n                  </div>\n                  <div v-if="results.length == 0 && searchString.length > 0" class="uip-text-muted uip-text-s">\n                    {{strings.nothingFound}} {{searchString}}\n                  </div>\n                  \n                  <div class="uip-flex uip-flex-between uip-gap-xxs uip-flex-center" v-if="searchString != \'\'">\n                    <div class="uip-padding-xs uip-padding-left-remove uip-text-muted">{{totalFound}} {{strings.found}}</div>\n                    <div class="uip-flex uip-gap-xs uip-padding-xs" v-if="totalPages > 1">\n                      <button @click="goBack" class="uip-button-default uip-icon uip-search-nav-button">chevron_left</button>\n                      <button @click="goForward" v-if="page < totalPages" class="uip-button-default uip-icon uip-search-nav-button">chevron_right</button>\n                    </div>\n                  </div>\n                  \n                </div>\n                \n              </template>\n              \n              \n            </div>'};